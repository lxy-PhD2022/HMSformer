Args in experiment:
Namespace(accumulation_steps=2, activation='gelu', affine=0, batch_size=48, c_out=7, checkpoints='./checkpoints/', compress_len=10, d_ff=128, d_layers=1, d_model=16, data='custom', data_path='national_illness.csv', dec_in=7, decomposition=0, des='Exp', device_ids=[0, 1, 2], devices='0,1,2', distil=True, do_predict=False, dropout=0.3, dvices='0,1,2', e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=18, learning_rate=0.0025, loss='mse', lradj='constant', model='MGSformer_TST', model_id='36_48', momentum=0.8, moving_avg=25, n=1, n_heads=4, n_intra=1, num_workers=10, output_attention=False, padding_patch='end', patch_len=24, patience=8, pct_start=0.3, period=24, pred_len=48, random_seed=2021, revin=1, root_path='./dataset/', seq_len=36, stride=2, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=True, x=5)
Use GPU: cuda:0
>>>>>>>start training : 24_1_1_36_48_MGSformer_TST_custom_ftM_sl36_ll18_pl48_dm20_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
module.model.backbone.W_pos_intra: 40
module.model.backbone.W_pos: 480
module.model.backbone.W_pos_coarse: 140
module.model.backbone.W_P_intra.weight: 960
module.model.backbone.W_P_intra.bias: 20
module.model.backbone.W_P.weight: 480
module.model.backbone.W_P.bias: 20
module.model.backbone.W_P_coarse.weight: 1400
module.model.backbone.W_P_coarse.bias: 20
module.model.backbone.encoder.layers.0.self_attn.W_Q.weight: 400
module.model.backbone.encoder.layers.0.self_attn.W_Q.bias: 20
module.model.backbone.encoder.layers.0.self_attn.W_K.weight: 400
module.model.backbone.encoder.layers.0.self_attn.W_K.bias: 20
module.model.backbone.encoder.layers.0.self_attn.W_V.weight: 400
module.model.backbone.encoder.layers.0.self_attn.W_V.bias: 20
module.model.backbone.encoder.layers.0.self_attn.to_out.0.weight: 400
module.model.backbone.encoder.layers.0.self_attn.to_out.0.bias: 20
module.model.backbone.encoder.layers.0.norm_attn.1.weight: 20
module.model.backbone.encoder.layers.0.norm_attn.1.bias: 20
module.model.backbone.encoder.layers.0.ff.0.weight: 2560
module.model.backbone.encoder.layers.0.ff.0.bias: 128
module.model.backbone.encoder.layers.0.ff.3.weight: 2560
module.model.backbone.encoder.layers.0.ff.3.bias: 20
module.model.backbone.encoder.layers.0.norm_ffn.1.weight: 20
module.model.backbone.encoder.layers.0.norm_ffn.1.bias: 20
module.model.backbone.encoder.layers.1.self_attn.W_Q.weight: 400
module.model.backbone.encoder.layers.1.self_attn.W_Q.bias: 20
module.model.backbone.encoder.layers.1.self_attn.W_K.weight: 400
module.model.backbone.encoder.layers.1.self_attn.W_K.bias: 20
module.model.backbone.encoder.layers.1.self_attn.W_V.weight: 400
module.model.backbone.encoder.layers.1.self_attn.W_V.bias: 20
module.model.backbone.encoder.layers.1.self_attn.to_out.0.weight: 400
module.model.backbone.encoder.layers.1.self_attn.to_out.0.bias: 20
module.model.backbone.encoder.layers.1.norm_attn.1.weight: 20
module.model.backbone.encoder.layers.1.norm_attn.1.bias: 20
module.model.backbone.encoder.layers.1.ff.0.weight: 2560
module.model.backbone.encoder.layers.1.ff.0.bias: 128
module.model.backbone.encoder.layers.1.ff.3.weight: 2560
module.model.backbone.encoder.layers.1.ff.3.bias: 20
module.model.backbone.encoder.layers.1.norm_ffn.1.weight: 20
module.model.backbone.encoder.layers.1.norm_ffn.1.bias: 20
module.model.backbone.encoder.layers.2.self_attn.W_Q.weight: 400
module.model.backbone.encoder.layers.2.self_attn.W_Q.bias: 20
module.model.backbone.encoder.layers.2.self_attn.W_K.weight: 400
module.model.backbone.encoder.layers.2.self_attn.W_K.bias: 20
module.model.backbone.encoder.layers.2.self_attn.W_V.weight: 400
module.model.backbone.encoder.layers.2.self_attn.W_V.bias: 20
module.model.backbone.encoder.layers.2.self_attn.to_out.0.weight: 400
module.model.backbone.encoder.layers.2.self_attn.to_out.0.bias: 20
module.model.backbone.encoder.layers.2.norm_attn.1.weight: 20
module.model.backbone.encoder.layers.2.norm_attn.1.bias: 20
module.model.backbone.encoder.layers.2.ff.0.weight: 2560
module.model.backbone.encoder.layers.2.ff.0.bias: 128
module.model.backbone.encoder.layers.2.ff.3.weight: 2560
module.model.backbone.encoder.layers.2.ff.3.bias: 20
module.model.backbone.encoder.layers.2.norm_ffn.1.weight: 20
module.model.backbone.encoder.layers.2.norm_ffn.1.bias: 20
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.weight: 400
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.bias: 20
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.weight: 400
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.bias: 20
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.weight: 400
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.bias: 20
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.weight: 400
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.bias: 20
module.model.backbone.encoder_intra.layers.0.norm_attn.1.weight: 20
module.model.backbone.encoder_intra.layers.0.norm_attn.1.bias: 20
module.model.backbone.encoder_intra.layers.0.ff.0.weight: 2560
module.model.backbone.encoder_intra.layers.0.ff.0.bias: 128
module.model.backbone.encoder_intra.layers.0.ff.3.weight: 2560
module.model.backbone.encoder_intra.layers.0.ff.3.bias: 20
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.weight: 20
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.bias: 20
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.weight: 400
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.bias: 20
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.weight: 400
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.bias: 20
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.weight: 400
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.bias: 20
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.weight: 400
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.bias: 20
module.model.backbone.encoder_intra.layers.1.norm_attn.1.weight: 20
module.model.backbone.encoder_intra.layers.1.norm_attn.1.bias: 20
module.model.backbone.encoder_intra.layers.1.ff.0.weight: 2560
module.model.backbone.encoder_intra.layers.1.ff.0.bias: 128
module.model.backbone.encoder_intra.layers.1.ff.3.weight: 2560
module.model.backbone.encoder_intra.layers.1.ff.3.bias: 20
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.weight: 20
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.bias: 20
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.weight: 400
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.bias: 20
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.weight: 400
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.bias: 20
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.weight: 400
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.bias: 20
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.weight: 400
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.bias: 20
module.model.backbone.encoder_intra.layers.2.norm_attn.1.weight: 20
module.model.backbone.encoder_intra.layers.2.norm_attn.1.bias: 20
module.model.backbone.encoder_intra.layers.2.ff.0.weight: 2560
module.model.backbone.encoder_intra.layers.2.ff.0.bias: 128
module.model.backbone.encoder_intra.layers.2.ff.3.weight: 2560
module.model.backbone.encoder_intra.layers.2.ff.3.bias: 20
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.weight: 20
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.bias: 20
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.weight: 400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.bias: 20
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.weight: 400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.bias: 20
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.weight: 400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.bias: 20
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.weight: 400
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.bias: 20
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.weight: 20
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.bias: 20
module.model.backbone.encoder_coarse.layers.0.ff.0.weight: 2560
module.model.backbone.encoder_coarse.layers.0.ff.0.bias: 128
module.model.backbone.encoder_coarse.layers.0.ff.3.weight: 2560
module.model.backbone.encoder_coarse.layers.0.ff.3.bias: 20
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.weight: 20
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.bias: 20
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.weight: 400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.bias: 20
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.weight: 400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.bias: 20
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.weight: 400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.bias: 20
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.weight: 400
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.bias: 20
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.weight: 20
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.bias: 20
module.model.backbone.encoder_coarse.layers.1.ff.0.weight: 2560
module.model.backbone.encoder_coarse.layers.1.ff.0.bias: 128
module.model.backbone.encoder_coarse.layers.1.ff.3.weight: 2560
module.model.backbone.encoder_coarse.layers.1.ff.3.bias: 20
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.weight: 20
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.bias: 20
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.weight: 400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.bias: 20
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.weight: 400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.bias: 20
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.weight: 400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.bias: 20
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.weight: 400
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.bias: 20
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.weight: 20
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.bias: 20
module.model.backbone.encoder_coarse.layers.2.ff.0.weight: 2560
module.model.backbone.encoder_coarse.layers.2.ff.0.bias: 128
module.model.backbone.encoder_coarse.layers.2.ff.3.weight: 2560
module.model.backbone.encoder_coarse.layers.2.ff.3.bias: 20
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.weight: 20
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.bias: 20
module.model.head.linear.weight: 48960
module.model.head.linear.bias: 48
module.model.compress.weight: 360
module.model.compress.bias: 10
Total trainable parameters: 116190
train 593
val 50
test 146
Epoch: 1 cost time: 3.512970209121704
[2024-12-08 00:13:20] [32mIntermediate result: 3.7666254  (Index 0)[0m
Epoch: 1, Steps: 12 | Train Loss: 1.0738137 Vali Loss: 0.5777307 Test Loss: 3.7666254
Validation loss decreased (inf --> 0.577731).  Saving model ...
Updating learning rate to 0.0025
Epoch: 2 cost time: 2.22737455368042
[2024-12-08 00:13:23] [32mIntermediate result: 3.2240393  (Index 1)[0m
Epoch: 2, Steps: 12 | Train Loss: 1.0044727 Vali Loss: 0.4704119 Test Loss: 3.2240393
Validation loss decreased (0.577731 --> 0.470412).  Saving model ...
Updating learning rate to 0.0025
Epoch: 3 cost time: 2.152876138687134
[2024-12-08 00:13:26] [32mIntermediate result: 2.7045612  (Index 2)[0m
Epoch: 3, Steps: 12 | Train Loss: 0.8115070 Vali Loss: 0.3586403 Test Loss: 2.7045612
Validation loss decreased (0.470412 --> 0.358640).  Saving model ...
Updating learning rate to 0.0025
Epoch: 4 cost time: 2.3761539459228516
[2024-12-08 00:13:30] [32mIntermediate result: 2.5016716  (Index 3)[0m
Epoch: 4, Steps: 12 | Train Loss: 0.7441382 Vali Loss: 0.3404472 Test Loss: 2.5016716
Validation loss decreased (0.358640 --> 0.340447).  Saving model ...
Updating learning rate to 0.0025
Epoch: 5 cost time: 2.213317632675171
[2024-12-08 00:13:33] [32mIntermediate result: 2.5980992  (Index 4)[0m
Epoch: 5, Steps: 12 | Train Loss: 0.6882389 Vali Loss: 0.3136239 Test Loss: 2.5980992
Validation loss decreased (0.340447 --> 0.313624).  Saving model ...
Updating learning rate to 0.0025
Epoch: 6 cost time: 2.0986127853393555
[2024-12-08 00:13:36] [32mIntermediate result: 2.6817605  (Index 5)[0m
Epoch: 6, Steps: 12 | Train Loss: 0.6549986 Vali Loss: 0.3279241 Test Loss: 2.6817605
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 7 cost time: 2.3417584896087646
[2024-12-08 00:13:40] [32mIntermediate result: 2.5971253  (Index 6)[0m
Epoch: 7, Steps: 12 | Train Loss: 0.6296652 Vali Loss: 0.3422329 Test Loss: 2.5971253
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 8 cost time: 2.0256762504577637
[2024-12-08 00:13:43] [32mIntermediate result: 2.3662708  (Index 7)[0m
Epoch: 8, Steps: 12 | Train Loss: 0.6122453 Vali Loss: 0.2840717 Test Loss: 2.3662708
Validation loss decreased (0.313624 --> 0.284072).  Saving model ...
Updating learning rate to 0.0025
Epoch: 9 cost time: 2.1342499256134033
[2024-12-08 00:13:46] [32mIntermediate result: 2.452502  (Index 8)[0m
Epoch: 9, Steps: 12 | Train Loss: 0.5852012 Vali Loss: 0.2828309 Test Loss: 2.4525020
Validation loss decreased (0.284072 --> 0.282831).  Saving model ...
Updating learning rate to 0.0025
Epoch: 10 cost time: 2.4531381130218506
[2024-12-08 00:13:49] [32mIntermediate result: 2.4562218  (Index 9)[0m
Epoch: 10, Steps: 12 | Train Loss: 0.5806645 Vali Loss: 0.2553125 Test Loss: 2.4562218
Validation loss decreased (0.282831 --> 0.255312).  Saving model ...
Updating learning rate to 0.0025
Epoch: 11 cost time: 2.1292502880096436
[2024-12-08 00:13:53] [32mIntermediate result: 2.4118176  (Index 10)[0m
Epoch: 11, Steps: 12 | Train Loss: 0.5761754 Vali Loss: 0.2442451 Test Loss: 2.4118176
Validation loss decreased (0.255312 --> 0.244245).  Saving model ...
Updating learning rate to 0.0025
Epoch: 12 cost time: 2.276780605316162
[2024-12-08 00:13:56] [32mIntermediate result: 2.4312239  (Index 11)[0m
Epoch: 12, Steps: 12 | Train Loss: 0.5673493 Vali Loss: 0.2746266 Test Loss: 2.4312239
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 13 cost time: 2.2448649406433105
[2024-12-08 00:13:59] [32mIntermediate result: 2.2655907  (Index 12)[0m
Epoch: 13, Steps: 12 | Train Loss: 0.5501581 Vali Loss: 0.2543897 Test Loss: 2.2655907
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 14 cost time: 2.363696336746216
[2024-12-08 00:14:03] [32mIntermediate result: 2.2106092  (Index 13)[0m
Epoch: 14, Steps: 12 | Train Loss: 0.5413642 Vali Loss: 0.2571971 Test Loss: 2.2106092
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 15 cost time: 2.352848768234253
[2024-12-08 00:14:06] [32mIntermediate result: 2.2272756  (Index 14)[0m
Epoch: 15, Steps: 12 | Train Loss: 0.5303963 Vali Loss: 0.2371998 Test Loss: 2.2272756
Validation loss decreased (0.244245 --> 0.237200).  Saving model ...
Updating learning rate to 0.0025
Epoch: 16 cost time: 2.3426878452301025
[2024-12-08 00:14:09] [32mIntermediate result: 2.1490514  (Index 15)[0m
Epoch: 16, Steps: 12 | Train Loss: 0.5264622 Vali Loss: 0.2456075 Test Loss: 2.1490514
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 17 cost time: 2.21032452583313
[2024-12-08 00:14:13] [32mIntermediate result: 2.334595  (Index 16)[0m
Epoch: 17, Steps: 12 | Train Loss: 0.5151021 Vali Loss: 0.2459520 Test Loss: 2.3345950
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 18 cost time: 2.525209903717041
[2024-12-08 00:14:16] [32mIntermediate result: 2.0470173  (Index 17)[0m
Epoch: 18, Steps: 12 | Train Loss: 0.5018308 Vali Loss: 0.2403253 Test Loss: 2.0470173
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 19 cost time: 2.2439441680908203
[2024-12-08 00:14:20] [32mIntermediate result: 2.259331  (Index 18)[0m
Epoch: 19, Steps: 12 | Train Loss: 0.5010590 Vali Loss: 0.2270330 Test Loss: 2.2593310
Validation loss decreased (0.237200 --> 0.227033).  Saving model ...
Updating learning rate to 0.0025
Epoch: 20 cost time: 2.432077169418335
[2024-12-08 00:14:23] [32mIntermediate result: 2.0677097  (Index 19)[0m
Epoch: 20, Steps: 12 | Train Loss: 0.4963724 Vali Loss: 0.2303155 Test Loss: 2.0677097
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 21 cost time: 2.1036531925201416
[2024-12-08 00:14:26] [32mIntermediate result: 2.0961056  (Index 20)[0m
Epoch: 21, Steps: 12 | Train Loss: 0.4805653 Vali Loss: 0.2250468 Test Loss: 2.0961056
Validation loss decreased (0.227033 --> 0.225047).  Saving model ...
Updating learning rate to 0.0025
Epoch: 22 cost time: 2.374079942703247
[2024-12-08 00:14:30] [32mIntermediate result: 2.1470242  (Index 21)[0m
Epoch: 22, Steps: 12 | Train Loss: 0.4679372 Vali Loss: 0.2564166 Test Loss: 2.1470242
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 23 cost time: 2.1154162883758545
[2024-12-08 00:14:33] [32mIntermediate result: 2.190677  (Index 22)[0m
Epoch: 23, Steps: 12 | Train Loss: 0.4689331 Vali Loss: 0.2097125 Test Loss: 2.1906769
Validation loss decreased (0.225047 --> 0.209713).  Saving model ...
Updating learning rate to 0.0025
Epoch: 24 cost time: 2.0949625968933105
[2024-12-08 00:14:36] [32mIntermediate result: 2.1617358  (Index 23)[0m
Epoch: 24, Steps: 12 | Train Loss: 0.4619566 Vali Loss: 0.2303843 Test Loss: 2.1617358
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 25 cost time: 2.187866449356079
[2024-12-08 00:14:39] [32mIntermediate result: 2.0798118  (Index 24)[0m
Epoch: 25, Steps: 12 | Train Loss: 0.4537988 Vali Loss: 0.2003379 Test Loss: 2.0798118
Validation loss decreased (0.209713 --> 0.200338).  Saving model ...
Updating learning rate to 0.0025
Epoch: 26 cost time: 2.2326269149780273
[2024-12-08 00:14:43] [32mIntermediate result: 2.143059  (Index 25)[0m
Epoch: 26, Steps: 12 | Train Loss: 0.4451220 Vali Loss: 0.2124382 Test Loss: 2.1430590
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0025
Epoch: 27 cost time: 2.405147075653076
[2024-12-08 00:14:46] [32mIntermediate result: 2.0982122  (Index 26)[0m
Epoch: 27, Steps: 12 | Train Loss: 0.4456805 Vali Loss: 0.2237234 Test Loss: 2.0982122
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0025
Epoch: 28 cost time: 2.4083163738250732
[2024-12-08 00:14:50] [32mIntermediate result: 2.0267565  (Index 27)[0m
Epoch: 28, Steps: 12 | Train Loss: 0.4491004 Vali Loss: 0.2130691 Test Loss: 2.0267565
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0025
Epoch: 29 cost time: 2.2584171295166016
[2024-12-08 00:14:53] [32mIntermediate result: 2.306117  (Index 28)[0m
Epoch: 29, Steps: 12 | Train Loss: 0.4458652 Vali Loss: 0.2152296 Test Loss: 2.3061171
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0025
Epoch: 30 cost time: 2.163156747817993
[2024-12-08 00:14:56] [32mIntermediate result: 2.1101806  (Index 29)[0m
Epoch: 30, Steps: 12 | Train Loss: 0.4475767 Vali Loss: 0.2281417 Test Loss: 2.1101806
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.0025
Epoch: 31 cost time: 2.2265374660491943
[2024-12-08 00:15:00] [32mIntermediate result: 2.1849844  (Index 30)[0m
Epoch: 31, Steps: 12 | Train Loss: 0.4441316 Vali Loss: 0.2139947 Test Loss: 2.1849844
EarlyStopping counter: 6 out of 8
Updating learning rate to 0.0025
Epoch: 32 cost time: 2.4278879165649414
[2024-12-08 00:15:03] [32mIntermediate result: 2.3339763  (Index 31)[0m
Epoch: 32, Steps: 12 | Train Loss: 0.4381061 Vali Loss: 0.2085768 Test Loss: 2.3339763
EarlyStopping counter: 7 out of 8
Updating learning rate to 0.0025
Epoch: 33 cost time: 2.1366279125213623
[2024-12-08 00:15:06] [32mIntermediate result: 2.067561  (Index 32)[0m
Epoch: 33, Steps: 12 | Train Loss: 0.4583447 Vali Loss: 0.2484631 Test Loss: 2.0675609
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 24_1_1_36_48_MGSformer_TST_custom_ftM_sl36_ll18_pl48_dm20_nh4_el3_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 146
mse:2.0798118114471436, mae:0.8881828784942627, rse:0.6898679733276367
[2024-12-08 00:15:07] [32mFinal result: 2.0798118[0m
