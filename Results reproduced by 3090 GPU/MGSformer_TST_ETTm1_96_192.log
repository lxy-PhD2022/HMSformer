Args in experiment:
Namespace(accumulation_steps=2, activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', compress_len=10, d_ff=256, d_layers=1, d_model=128, data='ETTm1', data_path='ETTm1.csv', dec_in=7, decomposition=0, des='Exp', device_ids=[0, 1, 2], devices='0,1,2', distil=True, do_predict=False, dropout=0.2, dvices='0,1,2', e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=18, learning_rate=0.0001, loss='mse', lradj='TST', model='MGSformer_TST', model_id='96_192', momentum=0.8, moving_avg=25, n=2, n_heads=16, n_intra=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.4, period=24, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=True, x=5)
Use GPU: cuda:0
>>>>>>>start training : 24_2_2_96_192_MGSformer_TST_ETTm1_ftM_sl96_ll18_pl192_dm80_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
module.model.backbone.W_pos_intra: 320
module.model.backbone.W_pos: 1920
module.model.backbone.W_pos_coarse: 560
module.model.backbone.W_P_intra.weight: 3840
module.model.backbone.W_P_intra.bias: 80
module.model.backbone.W_P.weight: 960
module.model.backbone.W_P.bias: 80
module.model.backbone.W_P_coarse.weight: 5600
module.model.backbone.W_P_coarse.bias: 80
module.model.backbone.encoder.layers.0.self_attn.W_Q.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.W_Q.bias: 80
module.model.backbone.encoder.layers.0.self_attn.W_K.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.W_K.bias: 80
module.model.backbone.encoder.layers.0.self_attn.W_V.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.W_V.bias: 80
module.model.backbone.encoder.layers.0.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.to_out.0.bias: 80
module.model.backbone.encoder.layers.0.norm_attn.1.weight: 80
module.model.backbone.encoder.layers.0.norm_attn.1.bias: 80
module.model.backbone.encoder.layers.0.ff.0.weight: 20480
module.model.backbone.encoder.layers.0.ff.0.bias: 256
module.model.backbone.encoder.layers.0.ff.3.weight: 20480
module.model.backbone.encoder.layers.0.ff.3.bias: 80
module.model.backbone.encoder.layers.0.norm_ffn.1.weight: 80
module.model.backbone.encoder.layers.0.norm_ffn.1.bias: 80
module.model.backbone.encoder.layers.1.self_attn.W_Q.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.W_Q.bias: 80
module.model.backbone.encoder.layers.1.self_attn.W_K.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.W_K.bias: 80
module.model.backbone.encoder.layers.1.self_attn.W_V.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.W_V.bias: 80
module.model.backbone.encoder.layers.1.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.to_out.0.bias: 80
module.model.backbone.encoder.layers.1.norm_attn.1.weight: 80
module.model.backbone.encoder.layers.1.norm_attn.1.bias: 80
module.model.backbone.encoder.layers.1.ff.0.weight: 20480
module.model.backbone.encoder.layers.1.ff.0.bias: 256
module.model.backbone.encoder.layers.1.ff.3.weight: 20480
module.model.backbone.encoder.layers.1.ff.3.bias: 80
module.model.backbone.encoder.layers.1.norm_ffn.1.weight: 80
module.model.backbone.encoder.layers.1.norm_ffn.1.bias: 80
module.model.backbone.encoder.layers.2.self_attn.W_Q.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.W_Q.bias: 80
module.model.backbone.encoder.layers.2.self_attn.W_K.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.W_K.bias: 80
module.model.backbone.encoder.layers.2.self_attn.W_V.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.W_V.bias: 80
module.model.backbone.encoder.layers.2.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.to_out.0.bias: 80
module.model.backbone.encoder.layers.2.norm_attn.1.weight: 80
module.model.backbone.encoder.layers.2.norm_attn.1.bias: 80
module.model.backbone.encoder.layers.2.ff.0.weight: 20480
module.model.backbone.encoder.layers.2.ff.0.bias: 256
module.model.backbone.encoder.layers.2.ff.3.weight: 20480
module.model.backbone.encoder.layers.2.ff.3.bias: 80
module.model.backbone.encoder.layers.2.norm_ffn.1.weight: 80
module.model.backbone.encoder.layers.2.norm_ffn.1.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_intra.layers.0.norm_attn.1.weight: 80
module.model.backbone.encoder_intra.layers.0.norm_attn.1.bias: 80
module.model.backbone.encoder_intra.layers.0.ff.0.weight: 20480
module.model.backbone.encoder_intra.layers.0.ff.0.bias: 256
module.model.backbone.encoder_intra.layers.0.ff.3.weight: 20480
module.model.backbone.encoder_intra.layers.0.ff.3.bias: 80
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.weight: 80
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_intra.layers.1.norm_attn.1.weight: 80
module.model.backbone.encoder_intra.layers.1.norm_attn.1.bias: 80
module.model.backbone.encoder_intra.layers.1.ff.0.weight: 20480
module.model.backbone.encoder_intra.layers.1.ff.0.bias: 256
module.model.backbone.encoder_intra.layers.1.ff.3.weight: 20480
module.model.backbone.encoder_intra.layers.1.ff.3.bias: 80
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.weight: 80
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_intra.layers.2.norm_attn.1.weight: 80
module.model.backbone.encoder_intra.layers.2.norm_attn.1.bias: 80
module.model.backbone.encoder_intra.layers.2.ff.0.weight: 20480
module.model.backbone.encoder_intra.layers.2.ff.0.bias: 256
module.model.backbone.encoder_intra.layers.2.ff.3.weight: 20480
module.model.backbone.encoder_intra.layers.2.ff.3.bias: 80
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.weight: 80
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.weight: 80
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.bias: 80
module.model.backbone.encoder_coarse.layers.0.ff.0.weight: 20480
module.model.backbone.encoder_coarse.layers.0.ff.0.bias: 256
module.model.backbone.encoder_coarse.layers.0.ff.3.weight: 20480
module.model.backbone.encoder_coarse.layers.0.ff.3.bias: 80
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.weight: 80
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.weight: 80
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.bias: 80
module.model.backbone.encoder_coarse.layers.1.ff.0.weight: 20480
module.model.backbone.encoder_coarse.layers.1.ff.0.bias: 256
module.model.backbone.encoder_coarse.layers.1.ff.3.weight: 20480
module.model.backbone.encoder_coarse.layers.1.ff.3.bias: 80
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.weight: 80
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.weight: 80
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.bias: 80
module.model.backbone.encoder_coarse.layers.2.ff.0.weight: 20480
module.model.backbone.encoder_coarse.layers.2.ff.0.bias: 256
module.model.backbone.encoder_coarse.layers.2.ff.3.weight: 20480
module.model.backbone.encoder_coarse.layers.2.ff.3.bias: 80
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.weight: 80
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.bias: 80
module.model.head.linear.weight: 1551360
module.model.head.linear.bias: 192
module.model.compress.weight: 960
module.model.compress.bias: 10
Total trainable parameters: 2173786
train 34273
val 11329
test 11329
	iters: 100, epoch: 1 | loss: 0.4728513
	speed: 0.1662s/iter; left time: 4419.8231s
	iters: 200, epoch: 1 | loss: 0.4545621
	speed: 0.1523s/iter; left time: 4037.3106s
Epoch: 1 cost time: 41.40773940086365
[2024-12-07 21:17:16] [32mIntermediate result: 0.4213316  (Index 0)[0m
Epoch: 1, Steps: 267 | Train Loss: 0.4603922 Vali Loss: 0.5677723 Test Loss: 0.4213316
Validation loss decreased (inf --> 0.567772).  Saving model ...
Updating learning rate to 4.147995679811901e-06
	iters: 100, epoch: 2 | loss: 0.4029616
	speed: 0.3752s/iter; left time: 9880.6745s
	iters: 200, epoch: 2 | loss: 0.3752996
	speed: 0.1446s/iter; left time: 3792.7480s
Epoch: 2 cost time: 39.28499746322632
[2024-12-07 21:18:07] [32mIntermediate result: 0.4027585  (Index 1)[0m
Epoch: 2, Steps: 267 | Train Loss: 0.4140782 Vali Loss: 0.5493982 Test Loss: 0.4027585
Validation loss decreased (0.567772 --> 0.549398).  Saving model ...
Updating learning rate to 4.591070105862505e-06
	iters: 100, epoch: 3 | loss: 0.4115941
	speed: 0.3676s/iter; left time: 9583.0351s
	iters: 200, epoch: 3 | loss: 0.3852190
	speed: 0.1424s/iter; left time: 3698.0897s
Epoch: 3 cost time: 38.61028575897217
[2024-12-07 21:18:58] [32mIntermediate result: 0.39513007  (Index 2)[0m
Epoch: 3, Steps: 267 | Train Loss: 0.3997813 Vali Loss: 0.5404123 Test Loss: 0.3951301
Validation loss decreased (0.549398 --> 0.540412).  Saving model ...
Updating learning rate to 5.326491065614654e-06
	iters: 100, epoch: 4 | loss: 0.3439381
	speed: 0.3710s/iter; left time: 9570.7911s
	iters: 200, epoch: 4 | loss: 0.3808542
	speed: 0.1441s/iter; left time: 3704.1350s
Epoch: 4 cost time: 39.02826452255249
[2024-12-07 21:19:51] [32mIntermediate result: 0.3920061  (Index 3)[0m
Epoch: 4, Steps: 267 | Train Loss: 0.3895233 Vali Loss: 0.5371185 Test Loss: 0.3920061
Validation loss decreased (0.540412 --> 0.537118).  Saving model ...
Updating learning rate to 6.349723595531451e-06
	iters: 100, epoch: 5 | loss: 0.3388413
	speed: 0.3749s/iter; left time: 9572.8328s
	iters: 200, epoch: 5 | loss: 0.3380855
	speed: 0.1391s/iter; left time: 3538.4660s
Epoch: 5 cost time: 37.833061933517456
[2024-12-07 21:20:40] [32mIntermediate result: 0.38705713  (Index 4)[0m
Epoch: 5, Steps: 267 | Train Loss: 0.3810517 Vali Loss: 0.5296189 Test Loss: 0.3870571
Validation loss decreased (0.537118 --> 0.529619).  Saving model ...
Updating learning rate to 7.654457945868284e-06
	iters: 100, epoch: 6 | loss: 0.3535658
	speed: 0.3614s/iter; left time: 9132.3749s
	iters: 200, epoch: 6 | loss: 0.3664478
	speed: 0.1435s/iter; left time: 3612.3383s
Epoch: 6 cost time: 38.911109924316406
[2024-12-07 21:21:32] [32mIntermediate result: 0.38285094  (Index 5)[0m
Epoch: 6, Steps: 267 | Train Loss: 0.3736778 Vali Loss: 0.5254815 Test Loss: 0.3828509
Validation loss decreased (0.529619 --> 0.525481).  Saving model ...
Updating learning rate to 9.232648489660472e-06
	iters: 100, epoch: 7 | loss: 0.3587780
	speed: 0.3717s/iter; left time: 9293.0495s
	iters: 200, epoch: 7 | loss: 0.3731876
	speed: 0.1432s/iter; left time: 3565.7565s
Epoch: 7 cost time: 38.85777401924133
[2024-12-07 21:22:23] [32mIntermediate result: 0.38106772  (Index 6)[0m
Epoch: 7, Steps: 267 | Train Loss: 0.3673765 Vali Loss: 0.5236873 Test Loss: 0.3810677
Validation loss decreased (0.525481 --> 0.523687).  Saving model ...
Updating learning rate to 1.1074563335974625e-05
	iters: 100, epoch: 8 | loss: 0.3595407
	speed: 0.3686s/iter; left time: 9116.1909s
	iters: 200, epoch: 8 | loss: 0.3730062
	speed: 0.1449s/iter; left time: 3569.1692s
Epoch: 8 cost time: 39.18722462654114
[2024-12-07 21:23:15] [32mIntermediate result: 0.37971485  (Index 7)[0m
Epoch: 8, Steps: 267 | Train Loss: 0.3620035 Vali Loss: 0.5195509 Test Loss: 0.3797148
Validation loss decreased (0.523687 --> 0.519551).  Saving model ...
Updating learning rate to 1.3168844341484282e-05
	iters: 100, epoch: 9 | loss: 0.3271677
	speed: 0.3689s/iter; left time: 9025.0132s
	iters: 200, epoch: 9 | loss: 0.3523440
	speed: 0.1423s/iter; left time: 3466.8168s
Epoch: 9 cost time: 38.653568744659424
[2024-12-07 21:24:06] [32mIntermediate result: 0.37805903  (Index 8)[0m
Epoch: 9, Steps: 267 | Train Loss: 0.3575456 Vali Loss: 0.5221590 Test Loss: 0.3780590
EarlyStopping counter: 1 out of 8
Updating learning rate to 1.550257715030906e-05
	iters: 100, epoch: 10 | loss: 0.3494481
	speed: 0.3677s/iter; left time: 8896.4113s
	iters: 200, epoch: 10 | loss: 0.3761630
	speed: 0.1432s/iter; left time: 3450.0206s
Epoch: 10 cost time: 38.663329124450684
[2024-12-07 21:24:57] [32mIntermediate result: 0.37485364  (Index 9)[0m
Epoch: 10, Steps: 267 | Train Loss: 0.3532570 Vali Loss: 0.5172301 Test Loss: 0.3748536
Validation loss decreased (0.519551 --> 0.517230).  Saving model ...
Updating learning rate to 1.8061370830218138e-05
	iters: 100, epoch: 11 | loss: 0.3573548
	speed: 0.3708s/iter; left time: 8873.1296s
	iters: 200, epoch: 11 | loss: 0.3317496
	speed: 0.1456s/iter; left time: 3469.1199s
Epoch: 11 cost time: 39.649383306503296
[2024-12-07 21:25:49] [32mIntermediate result: 0.372027  (Index 10)[0m
Epoch: 11, Steps: 267 | Train Loss: 0.3489125 Vali Loss: 0.5143489 Test Loss: 0.3720270
Validation loss decreased (0.517230 --> 0.514349).  Saving model ...
Updating learning rate to 2.0829446614121635e-05
	iters: 100, epoch: 12 | loss: 0.3290071
	speed: 0.3762s/iter; left time: 8902.4087s
	iters: 200, epoch: 12 | loss: 0.3394105
	speed: 0.1415s/iter; left time: 3333.7170s
Epoch: 12 cost time: 38.72587704658508
[2024-12-07 21:26:40] [32mIntermediate result: 0.37228954  (Index 11)[0m
Epoch: 12, Steps: 267 | Train Loss: 0.3444620 Vali Loss: 0.5148984 Test Loss: 0.3722895
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.3789735199627454e-05
	iters: 100, epoch: 13 | loss: 0.3762781
	speed: 0.3646s/iter; left time: 8531.0098s
	iters: 200, epoch: 13 | loss: 0.3257938
	speed: 0.1424s/iter; left time: 3316.5995s
Epoch: 13 cost time: 38.47874164581299
[2024-12-07 21:27:31] [32mIntermediate result: 0.36793363  (Index 12)[0m
Epoch: 13, Steps: 267 | Train Loss: 0.3398848 Vali Loss: 0.5112543 Test Loss: 0.3679336
Validation loss decreased (0.514349 --> 0.511254).  Saving model ...
Updating learning rate to 2.6923982006666833e-05
	iters: 100, epoch: 14 | loss: 0.3173712
	speed: 0.3677s/iter; left time: 8504.1576s
	iters: 200, epoch: 14 | loss: 0.3469619
	speed: 0.1453s/iter; left time: 3346.4419s
Epoch: 14 cost time: 39.31311249732971
[2024-12-07 21:28:22] [32mIntermediate result: 0.3657807  (Index 13)[0m
Epoch: 14, Steps: 267 | Train Loss: 0.3359182 Vali Loss: 0.5088013 Test Loss: 0.3657807
Validation loss decreased (0.511254 --> 0.508801).  Saving model ...
Updating learning rate to 3.021285974411866e-05
	iters: 100, epoch: 15 | loss: 0.3398341
	speed: 0.3703s/iter; left time: 8467.2317s
	iters: 200, epoch: 15 | loss: 0.3277699
	speed: 0.1448s/iter; left time: 3295.1793s
Epoch: 15 cost time: 39.2277729511261
[2024-12-07 21:29:14] [32mIntermediate result: 0.36486828  (Index 14)[0m
Epoch: 15, Steps: 267 | Train Loss: 0.3326942 Vali Loss: 0.5064987 Test Loss: 0.3648683
Validation loss decreased (0.508801 --> 0.506499).  Saving model ...
Updating learning rate to 3.363608759129243e-05
	iters: 100, epoch: 16 | loss: 0.3148845
	speed: 0.3776s/iter; left time: 8531.9818s
	iters: 200, epoch: 16 | loss: 0.3380208
	speed: 0.1435s/iter; left time: 3227.8845s
Epoch: 16 cost time: 39.14397168159485
[2024-12-07 21:30:06] [32mIntermediate result: 0.36521405  (Index 15)[0m
Epoch: 16, Steps: 267 | Train Loss: 0.3293590 Vali Loss: 0.5048460 Test Loss: 0.3652140
Validation loss decreased (0.506499 --> 0.504846).  Saving model ...
Updating learning rate to 3.71725562593384e-05
	iters: 100, epoch: 17 | loss: 0.3332454
	speed: 0.3773s/iter; left time: 8425.1767s
	iters: 200, epoch: 17 | loss: 0.3215035
	speed: 0.1433s/iter; left time: 3184.4489s
Epoch: 17 cost time: 38.94769477844238
[2024-12-07 21:30:58] [32mIntermediate result: 0.36526966  (Index 16)[0m
Epoch: 17, Steps: 267 | Train Loss: 0.3266658 Vali Loss: 0.5074682 Test Loss: 0.3652697
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.08004581613957e-05
	iters: 100, epoch: 18 | loss: 0.3308291
	speed: 0.3687s/iter; left time: 8133.6185s
	iters: 200, epoch: 18 | loss: 0.3577202
	speed: 0.1443s/iter; left time: 3169.3156s
Epoch: 18 cost time: 39.06134748458862
[2024-12-07 21:31:49] [32mIntermediate result: 0.3640846  (Index 17)[0m
Epoch: 18, Steps: 267 | Train Loss: 0.3238155 Vali Loss: 0.5038370 Test Loss: 0.3640846
Validation loss decreased (0.504846 --> 0.503837).  Saving model ...
Updating learning rate to 4.449742188878575e-05
	iters: 100, epoch: 19 | loss: 0.3183709
	speed: 0.3694s/iter; left time: 8051.4146s
	iters: 200, epoch: 19 | loss: 0.2916581
	speed: 0.1426s/iter; left time: 3092.9975s
Epoch: 19 cost time: 38.72682332992554
[2024-12-07 21:32:40] [32mIntermediate result: 0.3633664  (Index 18)[0m
Epoch: 19, Steps: 267 | Train Loss: 0.3215203 Vali Loss: 0.4990212 Test Loss: 0.3633664
Validation loss decreased (0.503837 --> 0.499021).  Saving model ...
Updating learning rate to 4.8240650164005444e-05
	iters: 100, epoch: 20 | loss: 0.3357452
	speed: 0.3661s/iter; left time: 7881.3956s
	iters: 200, epoch: 20 | loss: 0.3473145
	speed: 0.1450s/iter; left time: 3106.8949s
Epoch: 20 cost time: 39.551491498947144
[2024-12-07 21:33:32] [32mIntermediate result: 0.36467016  (Index 19)[0m
Epoch: 20, Steps: 267 | Train Loss: 0.3191133 Vali Loss: 0.5009267 Test Loss: 0.3646702
EarlyStopping counter: 1 out of 8
Updating learning rate to 5.2007060419834655e-05
	iters: 100, epoch: 21 | loss: 0.2939682
	speed: 0.3743s/iter; left time: 7957.4792s
	iters: 200, epoch: 21 | loss: 0.3517037
	speed: 0.1427s/iter; left time: 3020.5908s
Epoch: 21 cost time: 38.934489011764526
[2024-12-07 21:34:24] [32mIntermediate result: 0.36376104  (Index 20)[0m
Epoch: 21, Steps: 267 | Train Loss: 0.3166301 Vali Loss: 0.5023075 Test Loss: 0.3637610
EarlyStopping counter: 2 out of 8
Updating learning rate to 5.577342713767916e-05
	iters: 100, epoch: 22 | loss: 0.3404464
	speed: 0.3778s/iter; left time: 7931.0442s
	iters: 200, epoch: 22 | loss: 0.3354804
	speed: 0.1422s/iter; left time: 2970.3449s
Epoch: 22 cost time: 38.59790897369385
[2024-12-07 21:35:15] [32mIntermediate result: 0.36352578  (Index 21)[0m
Epoch: 22, Steps: 267 | Train Loss: 0.3142421 Vali Loss: 0.5052190 Test Loss: 0.3635258
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.95165250674211e-05
	iters: 100, epoch: 23 | loss: 0.2819352
	speed: 0.3707s/iter; left time: 7684.4167s
	iters: 200, epoch: 23 | loss: 0.3188701
	speed: 0.1411s/iter; left time: 2910.3715s
Epoch: 23 cost time: 38.37861967086792
[2024-12-07 21:36:06] [32mIntermediate result: 0.36544323  (Index 22)[0m
Epoch: 23, Steps: 267 | Train Loss: 0.3122129 Vali Loss: 0.4954224 Test Loss: 0.3654432
Validation loss decreased (0.499021 --> 0.495422).  Saving model ...
Updating learning rate to 6.321327244561401e-05
	iters: 100, epoch: 24 | loss: 0.3278390
	speed: 0.3682s/iter; left time: 7533.7007s
	iters: 200, epoch: 24 | loss: 0.3415247
	speed: 0.1475s/iter; left time: 3003.0403s
Epoch: 24 cost time: 39.64618539810181
[2024-12-07 21:36:58] [32mIntermediate result: 0.363747  (Index 23)[0m
Epoch: 24, Steps: 267 | Train Loss: 0.3099330 Vali Loss: 0.5000651 Test Loss: 0.3637470
EarlyStopping counter: 1 out of 8
Updating learning rate to 6.684087332886925e-05
	iters: 100, epoch: 25 | loss: 0.3087201
	speed: 0.3702s/iter; left time: 7475.0112s
	iters: 200, epoch: 25 | loss: 0.2821483
	speed: 0.1469s/iter; left time: 2951.0847s
Epoch: 25 cost time: 39.228594064712524
[2024-12-07 21:37:50] [32mIntermediate result: 0.3629316  (Index 24)[0m
Epoch: 25, Steps: 267 | Train Loss: 0.3075588 Vali Loss: 0.5005561 Test Loss: 0.3629316
EarlyStopping counter: 2 out of 8
Updating learning rate to 7.037695816473663e-05
	iters: 100, epoch: 26 | loss: 0.2969565
	speed: 0.3755s/iter; left time: 7481.4171s
	iters: 200, epoch: 26 | loss: 0.3081022
	speed: 0.1516s/iter; left time: 3005.4795s
Epoch: 26 cost time: 40.94649577140808
[2024-12-07 21:38:43] [32mIntermediate result: 0.3669676  (Index 25)[0m
Epoch: 26, Steps: 267 | Train Loss: 0.3053283 Vali Loss: 0.5002890 Test Loss: 0.3669676
EarlyStopping counter: 3 out of 8
Updating learning rate to 7.37997217332513e-05
	iters: 100, epoch: 27 | loss: 0.3150826
	speed: 0.3848s/iter; left time: 7564.2105s
	iters: 200, epoch: 27 | loss: 0.2941814
	speed: 0.1471s/iter; left time: 2877.8323s
Epoch: 27 cost time: 40.490883588790894
[2024-12-07 21:39:36] [32mIntermediate result: 0.37143996  (Index 26)[0m
Epoch: 27, Steps: 267 | Train Loss: 0.3033279 Vali Loss: 0.5016911 Test Loss: 0.3714400
EarlyStopping counter: 4 out of 8
Updating learning rate to 7.708805760853169e-05
	iters: 100, epoch: 28 | loss: 0.2929067
	speed: 0.3780s/iter; left time: 7330.3935s
	iters: 200, epoch: 28 | loss: 0.3116166
	speed: 0.1546s/iter; left time: 2981.6119s
Epoch: 28 cost time: 41.45976686477661
[2024-12-07 21:40:31] [32mIntermediate result: 0.36525849  (Index 27)[0m
Epoch: 28, Steps: 267 | Train Loss: 0.3012828 Vali Loss: 0.5017811 Test Loss: 0.3652585
EarlyStopping counter: 5 out of 8
Updating learning rate to 8.022168831127312e-05
	iters: 100, epoch: 29 | loss: 0.3002093
	speed: 0.3982s/iter; left time: 7615.0805s
	iters: 200, epoch: 29 | loss: 0.3168193
	speed: 0.1491s/iter; left time: 2837.4353s
Epoch: 29 cost time: 40.27969169616699
[2024-12-07 21:41:25] [32mIntermediate result: 0.36605895  (Index 28)[0m
Epoch: 29, Steps: 267 | Train Loss: 0.2988083 Vali Loss: 0.5043815 Test Loss: 0.3660589
EarlyStopping counter: 6 out of 8
Updating learning rate to 8.318129034955344e-05
	iters: 100, epoch: 30 | loss: 0.2828022
	speed: 0.3867s/iter; left time: 7292.5312s
	iters: 200, epoch: 30 | loss: 0.3042186
	speed: 0.1464s/iter; left time: 2745.6859s
Epoch: 30 cost time: 40.16349720954895
[2024-12-07 21:42:17] [32mIntermediate result: 0.36757994  (Index 29)[0m
Epoch: 30, Steps: 267 | Train Loss: 0.2971913 Vali Loss: 0.5020249 Test Loss: 0.3675799
EarlyStopping counter: 7 out of 8
Updating learning rate to 8.594861337688816e-05
	iters: 100, epoch: 31 | loss: 0.2854946
	speed: 0.3823s/iter; left time: 7107.2142s
	iters: 200, epoch: 31 | loss: 0.3087321
	speed: 0.1458s/iter; left time: 2695.8224s
Epoch: 31 cost time: 40.8098623752594
[2024-12-07 21:43:11] [32mIntermediate result: 0.37399533  (Index 30)[0m
Epoch: 31, Steps: 267 | Train Loss: 0.2946966 Vali Loss: 0.5057192 Test Loss: 0.3739953
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 24_2_2_96_192_MGSformer_TST_ETTm1_ftM_sl96_ll18_pl192_dm80_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.36544275283813477, mae:0.38750696182250977, rse:0.5749818086624146
[2024-12-07 21:43:19] [32mFinal result: 0.36544275[0m
