Args in experiment:
Namespace(accumulation_steps=2, activation='gelu', affine=0, batch_size=128, c_out=7, checkpoints='./checkpoints/', compress_len=10, d_ff=256, d_layers=1, d_model=128, data='ETTm2', data_path='ETTm2.csv', dec_in=7, decomposition=0, des='Exp', device_ids=[0, 1, 2], devices='0,1,2', distil=True, do_predict=False, dropout=0.2, dvices='0,1,2', e_layers=3, embed='timeF', embed_type=0, enc_in=7, factor=1, fc_dropout=0.2, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=18, learning_rate=0.0001, loss='mse', lradj='TST', model='MGSformer_TST', model_id='96_96', momentum=0.8, moving_avg=25, n=2, n_heads=16, n_intra=2, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.4, period=24, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=True, x=5)
Use GPU: cuda:0
>>>>>>>start training : 24_2_2_96_96_MGSformer_TST_ETTm2_ftM_sl96_ll18_pl96_dm80_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
module.model.backbone.W_pos_intra: 320
module.model.backbone.W_pos: 1920
module.model.backbone.W_pos_coarse: 560
module.model.backbone.W_P_intra.weight: 3840
module.model.backbone.W_P_intra.bias: 80
module.model.backbone.W_P.weight: 960
module.model.backbone.W_P.bias: 80
module.model.backbone.W_P_coarse.weight: 5600
module.model.backbone.W_P_coarse.bias: 80
module.model.backbone.encoder.layers.0.self_attn.W_Q.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.W_Q.bias: 80
module.model.backbone.encoder.layers.0.self_attn.W_K.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.W_K.bias: 80
module.model.backbone.encoder.layers.0.self_attn.W_V.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.W_V.bias: 80
module.model.backbone.encoder.layers.0.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder.layers.0.self_attn.to_out.0.bias: 80
module.model.backbone.encoder.layers.0.norm_attn.1.weight: 80
module.model.backbone.encoder.layers.0.norm_attn.1.bias: 80
module.model.backbone.encoder.layers.0.ff.0.weight: 20480
module.model.backbone.encoder.layers.0.ff.0.bias: 256
module.model.backbone.encoder.layers.0.ff.3.weight: 20480
module.model.backbone.encoder.layers.0.ff.3.bias: 80
module.model.backbone.encoder.layers.0.norm_ffn.1.weight: 80
module.model.backbone.encoder.layers.0.norm_ffn.1.bias: 80
module.model.backbone.encoder.layers.1.self_attn.W_Q.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.W_Q.bias: 80
module.model.backbone.encoder.layers.1.self_attn.W_K.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.W_K.bias: 80
module.model.backbone.encoder.layers.1.self_attn.W_V.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.W_V.bias: 80
module.model.backbone.encoder.layers.1.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder.layers.1.self_attn.to_out.0.bias: 80
module.model.backbone.encoder.layers.1.norm_attn.1.weight: 80
module.model.backbone.encoder.layers.1.norm_attn.1.bias: 80
module.model.backbone.encoder.layers.1.ff.0.weight: 20480
module.model.backbone.encoder.layers.1.ff.0.bias: 256
module.model.backbone.encoder.layers.1.ff.3.weight: 20480
module.model.backbone.encoder.layers.1.ff.3.bias: 80
module.model.backbone.encoder.layers.1.norm_ffn.1.weight: 80
module.model.backbone.encoder.layers.1.norm_ffn.1.bias: 80
module.model.backbone.encoder.layers.2.self_attn.W_Q.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.W_Q.bias: 80
module.model.backbone.encoder.layers.2.self_attn.W_K.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.W_K.bias: 80
module.model.backbone.encoder.layers.2.self_attn.W_V.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.W_V.bias: 80
module.model.backbone.encoder.layers.2.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder.layers.2.self_attn.to_out.0.bias: 80
module.model.backbone.encoder.layers.2.norm_attn.1.weight: 80
module.model.backbone.encoder.layers.2.norm_attn.1.bias: 80
module.model.backbone.encoder.layers.2.ff.0.weight: 20480
module.model.backbone.encoder.layers.2.ff.0.bias: 256
module.model.backbone.encoder.layers.2.ff.3.weight: 20480
module.model.backbone.encoder.layers.2.ff.3.bias: 80
module.model.backbone.encoder.layers.2.norm_ffn.1.weight: 80
module.model.backbone.encoder.layers.2.norm_ffn.1.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.bias: 80
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_intra.layers.0.norm_attn.1.weight: 80
module.model.backbone.encoder_intra.layers.0.norm_attn.1.bias: 80
module.model.backbone.encoder_intra.layers.0.ff.0.weight: 20480
module.model.backbone.encoder_intra.layers.0.ff.0.bias: 256
module.model.backbone.encoder_intra.layers.0.ff.3.weight: 20480
module.model.backbone.encoder_intra.layers.0.ff.3.bias: 80
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.weight: 80
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.bias: 80
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_intra.layers.1.norm_attn.1.weight: 80
module.model.backbone.encoder_intra.layers.1.norm_attn.1.bias: 80
module.model.backbone.encoder_intra.layers.1.ff.0.weight: 20480
module.model.backbone.encoder_intra.layers.1.ff.0.bias: 256
module.model.backbone.encoder_intra.layers.1.ff.3.weight: 20480
module.model.backbone.encoder_intra.layers.1.ff.3.bias: 80
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.weight: 80
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.bias: 80
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_intra.layers.2.norm_attn.1.weight: 80
module.model.backbone.encoder_intra.layers.2.norm_attn.1.bias: 80
module.model.backbone.encoder_intra.layers.2.ff.0.weight: 20480
module.model.backbone.encoder_intra.layers.2.ff.0.bias: 256
module.model.backbone.encoder_intra.layers.2.ff.3.weight: 20480
module.model.backbone.encoder_intra.layers.2.ff.3.bias: 80
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.weight: 80
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.bias: 80
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.weight: 80
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.bias: 80
module.model.backbone.encoder_coarse.layers.0.ff.0.weight: 20480
module.model.backbone.encoder_coarse.layers.0.ff.0.bias: 256
module.model.backbone.encoder_coarse.layers.0.ff.3.weight: 20480
module.model.backbone.encoder_coarse.layers.0.ff.3.bias: 80
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.weight: 80
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.bias: 80
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.weight: 80
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.bias: 80
module.model.backbone.encoder_coarse.layers.1.ff.0.weight: 20480
module.model.backbone.encoder_coarse.layers.1.ff.0.bias: 256
module.model.backbone.encoder_coarse.layers.1.ff.3.weight: 20480
module.model.backbone.encoder_coarse.layers.1.ff.3.bias: 80
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.weight: 80
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.bias: 80
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.weight: 6400
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.bias: 80
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.weight: 80
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.bias: 80
module.model.backbone.encoder_coarse.layers.2.ff.0.weight: 20480
module.model.backbone.encoder_coarse.layers.2.ff.0.bias: 256
module.model.backbone.encoder_coarse.layers.2.ff.3.weight: 20480
module.model.backbone.encoder_coarse.layers.2.ff.3.bias: 80
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.weight: 80
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.bias: 80
module.model.head.linear.weight: 775680
module.model.head.linear.bias: 96
module.model.compress.weight: 960
module.model.compress.bias: 10
Total trainable parameters: 1398010
train 34369
val 11425
test 11425
	iters: 100, epoch: 1 | loss: 0.4054568
	speed: 0.1660s/iter; left time: 4432.2602s
	iters: 200, epoch: 1 | loss: 0.3287274
	speed: 0.1442s/iter; left time: 3835.5053s
Epoch: 1 cost time: 41.08373951911926
[2024-12-07 22:47:23] [32mIntermediate result: 0.19641685  (Index 0)[0m
Epoch: 1, Steps: 268 | Train Loss: 0.2913503 Vali Loss: 0.1374847 Test Loss: 0.1964169
Validation loss decreased (inf --> 0.137485).  Saving model ...
Updating learning rate to 4.147995576442968e-06
	iters: 100, epoch: 2 | loss: 0.2268950
	speed: 0.3874s/iter; left time: 10240.2619s
	iters: 200, epoch: 2 | loss: 0.4373524
	speed: 0.1459s/iter; left time: 3842.4584s
Epoch: 2 cost time: 39.86635136604309
[2024-12-07 22:48:16] [32mIntermediate result: 0.19038004  (Index 1)[0m
Epoch: 2, Steps: 268 | Train Loss: 0.2671999 Vali Loss: 0.1333180 Test Loss: 0.1903800
Validation loss decreased (0.137485 --> 0.133318).  Saving model ...
Updating learning rate to 4.5910696936615785e-06
	iters: 100, epoch: 3 | loss: 0.2322551
	speed: 0.3768s/iter; left time: 9859.8867s
	iters: 200, epoch: 3 | loss: 0.1837008
	speed: 0.1439s/iter; left time: 3750.7526s
Epoch: 3 cost time: 38.96508741378784
[2024-12-07 22:49:07] [32mIntermediate result: 0.1869507  (Index 2)[0m
Epoch: 3, Steps: 268 | Train Loss: 0.2591606 Vali Loss: 0.1305061 Test Loss: 0.1869507
Validation loss decreased (0.133318 --> 0.130506).  Saving model ...
Updating learning rate to 5.326490142931487e-06
	iters: 100, epoch: 4 | loss: 0.1773922
	speed: 0.3730s/iter; left time: 9659.8475s
	iters: 200, epoch: 4 | loss: 0.3753608
	speed: 0.1461s/iter; left time: 3769.7732s
Epoch: 4 cost time: 39.41985249519348
[2024-12-07 22:50:00] [32mIntermediate result: 0.18528242  (Index 3)[0m
Epoch: 4, Steps: 268 | Train Loss: 0.2533027 Vali Loss: 0.1297141 Test Loss: 0.1852824
Validation loss decreased (0.130506 --> 0.129714).  Saving model ...
Updating learning rate to 6.349721967031111e-06
	iters: 100, epoch: 5 | loss: 0.3610339
	speed: 0.3784s/iter; left time: 9696.8562s
	iters: 200, epoch: 5 | loss: 0.2115026
	speed: 0.1461s/iter; left time: 3729.4093s
Epoch: 5 cost time: 39.53508996963501
[2024-12-07 22:50:52] [32mIntermediate result: 0.18331458  (Index 4)[0m
Epoch: 5, Steps: 268 | Train Loss: 0.2495904 Vali Loss: 0.1284115 Test Loss: 0.1833146
Validation loss decreased (0.129714 --> 0.128412).  Saving model ...
Updating learning rate to 7.654455424975352e-06
	iters: 100, epoch: 6 | loss: 0.2167248
	speed: 0.3744s/iter; left time: 9493.9675s
	iters: 200, epoch: 6 | loss: 0.2793835
	speed: 0.1507s/iter; left time: 3808.0798s
Epoch: 6 cost time: 39.6537344455719
[2024-12-07 22:51:44] [32mIntermediate result: 0.18263048  (Index 5)[0m
Epoch: 6, Steps: 268 | Train Loss: 0.2452017 Vali Loss: 0.1291411 Test Loss: 0.1826305
EarlyStopping counter: 1 out of 8
Updating learning rate to 9.232644900922021e-06
	iters: 100, epoch: 7 | loss: 0.2473467
	speed: 0.3772s/iter; left time: 9465.4319s
	iters: 200, epoch: 7 | loss: 0.2225129
	speed: 0.1450s/iter; left time: 3623.9610s
Epoch: 7 cost time: 40.18209671974182
[2024-12-07 22:52:37] [32mIntermediate result: 0.17982057  (Index 6)[0m
Epoch: 7, Steps: 268 | Train Loss: 0.2408230 Vali Loss: 0.1274300 Test Loss: 0.1798206
Validation loss decreased (0.128412 --> 0.127430).  Saving model ...
Updating learning rate to 1.10745585173199e-05
	iters: 100, epoch: 8 | loss: 0.3275724
	speed: 0.3835s/iter; left time: 9519.8817s
	iters: 200, epoch: 8 | loss: 0.2798941
	speed: 0.1462s/iter; left time: 3615.1983s
Epoch: 8 cost time: 39.89415764808655
[2024-12-07 22:53:30] [32mIntermediate result: 0.17810123  (Index 7)[0m
Epoch: 8, Steps: 268 | Train Loss: 0.2366753 Vali Loss: 0.1273691 Test Loss: 0.1781012
Validation loss decreased (0.127430 --> 0.127369).  Saving model ...
Updating learning rate to 1.3168838146359926e-05
	iters: 100, epoch: 9 | loss: 0.1958558
	speed: 0.3841s/iter; left time: 9431.9864s
	iters: 200, epoch: 9 | loss: 0.2009176
	speed: 0.1446s/iter; left time: 3537.1917s
Epoch: 9 cost time: 39.589813232421875
[2024-12-07 22:54:23] [32mIntermediate result: 0.17649713  (Index 8)[0m
Epoch: 9, Steps: 268 | Train Loss: 0.2330071 Vali Loss: 0.1259885 Test Loss: 0.1764971
Validation loss decreased (0.127369 --> 0.125989).  Saving model ...
Updating learning rate to 1.5502569449669956e-05
	iters: 100, epoch: 10 | loss: 0.2169014
	speed: 0.3774s/iter; left time: 9167.0659s
	iters: 200, epoch: 10 | loss: 0.3463311
	speed: 0.1438s/iter; left time: 3477.6756s
Epoch: 10 cost time: 39.19368267059326
[2024-12-07 22:55:14] [32mIntermediate result: 0.1761307  (Index 9)[0m
Epoch: 10, Steps: 268 | Train Loss: 0.2293942 Vali Loss: 0.1269294 Test Loss: 0.1761307
EarlyStopping counter: 1 out of 8
Updating learning rate to 1.8061361514354275e-05
	iters: 100, epoch: 11 | loss: 0.2098752
	speed: 0.3686s/iter; left time: 8853.8063s
	iters: 200, epoch: 11 | loss: 0.2250824
	speed: 0.1446s/iter; left time: 3458.3495s
Epoch: 11 cost time: 39.29976534843445
[2024-12-07 22:56:09] [32mIntermediate result: 0.17485842  (Index 10)[0m
Epoch: 11, Steps: 268 | Train Loss: 0.2265138 Vali Loss: 0.1259938 Test Loss: 0.1748584
EarlyStopping counter: 2 out of 8
Updating learning rate to 2.082943559430413e-05
	iters: 100, epoch: 12 | loss: 0.2192316
	speed: 0.4046s/iter; left time: 9610.3552s
	iters: 200, epoch: 12 | loss: 0.1943590
	speed: 0.1444s/iter; left time: 3415.5533s
Epoch: 12 cost time: 39.056288719177246
[2024-12-07 22:57:01] [32mIntermediate result: 0.17359889  (Index 11)[0m
Epoch: 12, Steps: 268 | Train Loss: 0.2231773 Vali Loss: 0.1248641 Test Loss: 0.1735989
Validation loss decreased (0.125989 --> 0.124864).  Saving model ...
Updating learning rate to 2.3789722409557032e-05
	iters: 100, epoch: 13 | loss: 0.1591378
	speed: 0.3739s/iter; left time: 8781.0427s
	iters: 200, epoch: 13 | loss: 0.1718015
	speed: 0.1448s/iter; left time: 3386.8148s
Epoch: 13 cost time: 39.32608437538147
[2024-12-07 22:57:52] [32mIntermediate result: 0.17444001  (Index 12)[0m
Epoch: 13, Steps: 268 | Train Loss: 0.2195059 Vali Loss: 0.1252369 Test Loss: 0.1744400
EarlyStopping counter: 1 out of 8
Updating learning rate to 2.6923967403710497e-05
	iters: 100, epoch: 14 | loss: 0.1765645
	speed: 0.3727s/iter; left time: 8652.0041s
	iters: 200, epoch: 14 | loss: 0.1984494
	speed: 0.1466s/iter; left time: 3389.3403s
Epoch: 14 cost time: 39.940118074417114
[2024-12-07 22:58:45] [32mIntermediate result: 0.17350054  (Index 13)[0m
Epoch: 14, Steps: 268 | Train Loss: 0.2154842 Vali Loss: 0.1242074 Test Loss: 0.1735005
Validation loss decreased (0.124864 --> 0.124207).  Saving model ...
Updating learning rate to 3.0212843310321912e-05
	iters: 100, epoch: 15 | loss: 0.2015580
	speed: 0.3811s/iter; left time: 8745.1611s
	iters: 200, epoch: 15 | loss: 0.2159098
	speed: 0.1465s/iter; left time: 3346.9726s
Epoch: 15 cost time: 39.61771774291992
[2024-12-07 22:59:38] [32mIntermediate result: 0.17445958  (Index 14)[0m
Epoch: 15, Steps: 268 | Train Loss: 0.2121736 Vali Loss: 0.1250047 Test Loss: 0.1744596
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.363606933415592e-05
	iters: 100, epoch: 16 | loss: 0.2610248
	speed: 0.3744s/iter; left time: 8491.8482s
	iters: 200, epoch: 16 | loss: 0.1719446
	speed: 0.1438s/iter; left time: 3247.2127s
Epoch: 16 cost time: 39.05928945541382
[2024-12-07 23:00:29] [32mIntermediate result: 0.17414872  (Index 15)[0m
Epoch: 16, Steps: 268 | Train Loss: 0.2091561 Vali Loss: 0.1243548 Test Loss: 0.1741487
EarlyStopping counter: 2 out of 8
Updating learning rate to 3.7172536212350335e-05
	iters: 100, epoch: 17 | loss: 0.1570995
	speed: 0.3737s/iter; left time: 8375.1159s
	iters: 200, epoch: 17 | loss: 0.1572594
	speed: 0.1441s/iter; left time: 3215.6211s
Epoch: 17 cost time: 38.930140018463135
[2024-12-07 23:01:20] [32mIntermediate result: 0.1741134  (Index 16)[0m
Epoch: 17, Steps: 268 | Train Loss: 0.2058952 Vali Loss: 0.1239739 Test Loss: 0.1741134
Validation loss decreased (0.124207 --> 0.123974).  Saving model ...
Updating learning rate to 4.0800436384313114e-05
	iters: 100, epoch: 18 | loss: 0.2542029
	speed: 0.3644s/iter; left time: 8068.5804s
	iters: 200, epoch: 18 | loss: 0.1757927
	speed: 0.1447s/iter; left time: 3190.0791s
Epoch: 18 cost time: 39.19891428947449
[2024-12-07 23:02:12] [32mIntermediate result: 0.17402506  (Index 17)[0m
Epoch: 18, Steps: 268 | Train Loss: 0.2034896 Vali Loss: 0.1257787 Test Loss: 0.1740251
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.4497398467659785e-05
	iters: 100, epoch: 19 | loss: 0.1997919
	speed: 0.3765s/iter; left time: 8237.6404s
	iters: 200, epoch: 19 | loss: 0.2111054
	speed: 0.1459s/iter; left time: 3176.2062s
Epoch: 19 cost time: 39.74969696998596
[2024-12-07 23:03:06] [32mIntermediate result: 0.1762306  (Index 18)[0m
Epoch: 19, Steps: 268 | Train Loss: 0.2014486 Vali Loss: 0.1253529 Test Loss: 0.1762306
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.8240625210948136e-05
	iters: 100, epoch: 20 | loss: 0.1510207
	speed: 0.3928s/iter; left time: 8488.5575s
	iters: 200, epoch: 20 | loss: 0.1607119
	speed: 0.1504s/iter; left time: 3234.9262s
Epoch: 20 cost time: 40.90209364891052
[2024-12-07 23:03:59] [32mIntermediate result: 0.17667776  (Index 19)[0m
Epoch: 20, Steps: 268 | Train Loss: 0.1990291 Vali Loss: 0.1244676 Test Loss: 0.1766778
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.200703407252694e-05
	iters: 100, epoch: 21 | loss: 0.1497928
	speed: 0.3790s/iter; left time: 8088.8246s
	iters: 200, epoch: 21 | loss: 0.2253862
	speed: 0.1512s/iter; left time: 3211.0826s
Epoch: 21 cost time: 40.77710175514221
[2024-12-07 23:04:52] [32mIntermediate result: 0.17540754  (Index 20)[0m
Epoch: 21, Steps: 268 | Train Loss: 0.1964198 Vali Loss: 0.1251370 Test Loss: 0.1754075
EarlyStopping counter: 4 out of 8
Updating learning rate to 5.577339955862164e-05
	iters: 100, epoch: 22 | loss: 0.1619987
	speed: 0.3876s/iter; left time: 8168.3101s
	iters: 200, epoch: 22 | loss: 0.1264900
	speed: 0.1530s/iter; left time: 3209.3551s
Epoch: 22 cost time: 41.42687487602234
[2024-12-07 23:05:48] [32mIntermediate result: 0.17496388  (Index 21)[0m
Epoch: 22, Steps: 268 | Train Loss: 0.1943463 Vali Loss: 0.1248746 Test Loss: 0.1749639
EarlyStopping counter: 5 out of 8
Updating learning rate to 5.951649644293187e-05
	iters: 100, epoch: 23 | loss: 0.1522032
	speed: 0.4082s/iter; left time: 8492.5692s
	iters: 200, epoch: 23 | loss: 0.1469281
	speed: 0.1490s/iter; left time: 3085.3638s
Epoch: 23 cost time: 41.192808866500854
[2024-12-07 23:06:42] [32mIntermediate result: 0.17909403  (Index 22)[0m
Epoch: 23, Steps: 268 | Train Loss: 0.1919048 Vali Loss: 0.1256989 Test Loss: 0.1790940
EarlyStopping counter: 6 out of 8
Updating learning rate to 6.321324298457946e-05
	iters: 100, epoch: 24 | loss: 0.2330978
	speed: 0.3838s/iter; left time: 7882.7751s
	iters: 200, epoch: 24 | loss: 0.1854710
	speed: 0.1451s/iter; left time: 2964.6240s
Epoch: 24 cost time: 40.04084849357605
[2024-12-07 23:07:34] [32mIntermediate result: 0.17733105  (Index 23)[0m
Epoch: 24, Steps: 268 | Train Loss: 0.1897664 Vali Loss: 0.1260222 Test Loss: 0.1773310
EarlyStopping counter: 7 out of 8
Updating learning rate to 6.684084326125629e-05
	iters: 100, epoch: 25 | loss: 0.2502349
	speed: 0.3717s/iter; left time: 7534.5810s
	iters: 200, epoch: 25 | loss: 0.1300384
	speed: 0.1454s/iter; left time: 2931.9583s
Epoch: 25 cost time: 39.251407861709595
[2024-12-07 23:08:25] [32mIntermediate result: 0.18071406  (Index 24)[0m
Epoch: 25, Steps: 268 | Train Loss: 0.1880185 Vali Loss: 0.1273175 Test Loss: 0.1807141
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 24_2_2_96_96_MGSformer_TST_ETTm2_ftM_sl96_ll18_pl96_dm80_nh16_el3_dl1_df256_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.17411339282989502, mae:0.2586868703365326, rse:0.33803510665893555
[2024-12-07 23:08:34] [32mFinal result: 0.1741134[0m
