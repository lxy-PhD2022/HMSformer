Args in experiment:
Namespace(accumulation_steps=8, activation='gelu', affine=0, batch_size=121, c_out=7, checkpoints='./checkpoints/', compress_len=10, d_ff=160, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', device_ids=[0, 1, 2], devices='0,1,2', distil=True, do_predict=False, dropout=0.28801281872508566, dvices='0,1,2', e_layers=8, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.31935425281318547, features='M', freq='h', gpu=0, head_dropout=0.23228521905588617, individual=0, is_training=1, itr=1, kernel_size=25, label_len=18, learning_rate=0.000998840061822514, loss='mse', lradj='type3', model='MGSformer_TST', model_id='96_96', momentum=0.9758700119546663, moving_avg=25, n=1, n_heads=9, n_intra=1, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.3, period=65, pred_len=96, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=True, x=5)
Use GPU: cuda:0
>>>>>>>start training : 65_1_1_96_96_MGSformer_TST_custom_ftM_sl96_ll18_pl96_dm45_nh9_el8_dl1_df160_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
module.model.backbone.W_pos_intra: 90
module.model.backbone.W_pos: 2925
module.model.backbone.W_pos_coarse: 945
module.model.backbone.W_P_intra.weight: 5850
module.model.backbone.W_P_intra.bias: 45
module.model.backbone.W_P.weight: 2925
module.model.backbone.W_P.bias: 45
module.model.backbone.W_P_coarse.weight: 9450
module.model.backbone.W_P_coarse.bias: 45
module.model.backbone.encoder.layers.0.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.0.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.0.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.0.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.0.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.0.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.0.ff.0.weight: 7200
module.model.backbone.encoder.layers.0.ff.0.bias: 160
module.model.backbone.encoder.layers.0.ff.3.weight: 7200
module.model.backbone.encoder.layers.0.ff.3.bias: 45
module.model.backbone.encoder.layers.0.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.0.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.1.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.1.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.1.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.1.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.1.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.1.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.1.ff.0.weight: 7200
module.model.backbone.encoder.layers.1.ff.0.bias: 160
module.model.backbone.encoder.layers.1.ff.3.weight: 7200
module.model.backbone.encoder.layers.1.ff.3.bias: 45
module.model.backbone.encoder.layers.1.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.1.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.2.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.2.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.2.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.2.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.2.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.2.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.2.ff.0.weight: 7200
module.model.backbone.encoder.layers.2.ff.0.bias: 160
module.model.backbone.encoder.layers.2.ff.3.weight: 7200
module.model.backbone.encoder.layers.2.ff.3.bias: 45
module.model.backbone.encoder.layers.2.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.2.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.3.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.3.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.3.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.3.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.3.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.3.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.3.ff.0.weight: 7200
module.model.backbone.encoder.layers.3.ff.0.bias: 160
module.model.backbone.encoder.layers.3.ff.3.weight: 7200
module.model.backbone.encoder.layers.3.ff.3.bias: 45
module.model.backbone.encoder.layers.3.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.3.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.4.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.4.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.4.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.4.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.4.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.4.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.4.ff.0.weight: 7200
module.model.backbone.encoder.layers.4.ff.0.bias: 160
module.model.backbone.encoder.layers.4.ff.3.weight: 7200
module.model.backbone.encoder.layers.4.ff.3.bias: 45
module.model.backbone.encoder.layers.4.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.4.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.5.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.5.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.5.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.5.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.5.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.5.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.5.ff.0.weight: 7200
module.model.backbone.encoder.layers.5.ff.0.bias: 160
module.model.backbone.encoder.layers.5.ff.3.weight: 7200
module.model.backbone.encoder.layers.5.ff.3.bias: 45
module.model.backbone.encoder.layers.5.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.5.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.6.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.6.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.6.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.6.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.6.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.6.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.6.ff.0.weight: 7200
module.model.backbone.encoder.layers.6.ff.0.bias: 160
module.model.backbone.encoder.layers.6.ff.3.weight: 7200
module.model.backbone.encoder.layers.6.ff.3.bias: 45
module.model.backbone.encoder.layers.6.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.6.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.7.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.7.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.7.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.7.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.7.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.7.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.7.ff.0.weight: 7200
module.model.backbone.encoder.layers.7.ff.0.bias: 160
module.model.backbone.encoder.layers.7.ff.3.weight: 7200
module.model.backbone.encoder.layers.7.ff.3.bias: 45
module.model.backbone.encoder.layers.7.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.7.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.0.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.0.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.0.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.0.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.0.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.0.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.1.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.1.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.1.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.1.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.1.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.1.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.2.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.2.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.2.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.2.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.2.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.2.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.3.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.3.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.3.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.3.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.3.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.3.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.3.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.3.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.4.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.4.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.4.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.4.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.4.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.4.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.4.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.4.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.5.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.5.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.5.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.5.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.5.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.5.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.5.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.5.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.6.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.6.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.6.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.6.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.6.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.6.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.6.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.6.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.7.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.7.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.7.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.7.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.7.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.7.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.7.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.7.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.0.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.0.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.0.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.0.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.1.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.1.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.1.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.1.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.2.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.2.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.2.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.2.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.3.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.3.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.3.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.3.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.3.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.3.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.3.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.3.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.4.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.4.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.4.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.4.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.4.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.4.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.4.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.4.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.5.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.5.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.5.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.5.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.5.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.5.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.5.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.5.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.6.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.6.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.6.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.6.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.6.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.6.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.6.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.6.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.7.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.7.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.7.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.7.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.7.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.7.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.7.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.7.norm_ffn.1.bias: 45
module.model.head.linear.weight: 574560
module.model.head.linear.bias: 96
module.model.compress.weight: 960
module.model.compress.bias: 10
Total trainable parameters: 1151506
train 36696
val 5175
test 10444
	iters: 100, epoch: 1 | loss: 0.6921054
	speed: 0.3709s/iter; left time: 11200.2672s
	iters: 200, epoch: 1 | loss: 0.5782774
	speed: 0.3598s/iter; left time: 10830.5931s
	iters: 300, epoch: 1 | loss: 0.6490135
	speed: 0.3596s/iter; left time: 10788.9863s
Epoch: 1 cost time: 109.58638215065002
[2024-12-07 14:41:59] [32mIntermediate result: 0.20100589  (Index 0)[0m
Epoch: 1, Steps: 303 | Train Loss: 0.7329575 Vali Loss: 0.5125821 Test Loss: 0.2010059
Validation loss decreased (inf --> 0.512582).  Saving model ...
Updating learning rate to 0.000998840061822514
	iters: 100, epoch: 2 | loss: 0.5532542
	speed: 0.6006s/iter; left time: 17956.5921s
	iters: 200, epoch: 2 | loss: 0.5398791
	speed: 0.3604s/iter; left time: 10740.0428s
	iters: 300, epoch: 2 | loss: 0.4819538
	speed: 0.3571s/iter; left time: 10604.7473s
Epoch: 2 cost time: 109.17163443565369
[2024-12-07 14:44:11] [32mIntermediate result: 0.18470395  (Index 1)[0m
Epoch: 2, Steps: 303 | Train Loss: 0.5847629 Vali Loss: 0.4668656 Test Loss: 0.1847039
Validation loss decreased (0.512582 --> 0.466866).  Saving model ...
Updating learning rate to 0.000998840061822514
	iters: 100, epoch: 3 | loss: 0.4521228
	speed: 0.6035s/iter; left time: 17861.3384s
	iters: 200, epoch: 3 | loss: 0.4227003
	speed: 0.3626s/iter; left time: 10694.7490s
	iters: 300, epoch: 3 | loss: 0.6305154
	speed: 0.3556s/iter; left time: 10453.3312s
Epoch: 3 cost time: 109.40813636779785
[2024-12-07 14:46:24] [32mIntermediate result: 0.176427  (Index 2)[0m
Epoch: 3, Steps: 303 | Train Loss: 0.5343726 Vali Loss: 0.4353147 Test Loss: 0.1764270
Validation loss decreased (0.466866 --> 0.435315).  Saving model ...
Updating learning rate to 0.000998840061822514
	iters: 100, epoch: 4 | loss: 0.6921984
	speed: 0.6084s/iter; left time: 17820.8332s
	iters: 200, epoch: 4 | loss: 0.6698371
	speed: 0.3611s/iter; left time: 10542.3544s
	iters: 300, epoch: 4 | loss: 0.5063383
	speed: 0.3635s/iter; left time: 10576.1367s
Epoch: 4 cost time: 110.20882749557495
[2024-12-07 14:48:37] [32mIntermediate result: 0.1758379  (Index 3)[0m
Epoch: 4, Steps: 303 | Train Loss: 0.5094263 Vali Loss: 0.4298692 Test Loss: 0.1758379
Validation loss decreased (0.435315 --> 0.429869).  Saving model ...
Updating learning rate to 0.0008989560556402627
	iters: 100, epoch: 5 | loss: 0.6194651
	speed: 0.6092s/iter; left time: 17659.9491s
	iters: 200, epoch: 5 | loss: 0.4430377
	speed: 0.3628s/iter; left time: 10480.3916s
	iters: 300, epoch: 5 | loss: 0.6408659
	speed: 0.3586s/iter; left time: 10322.6798s
Epoch: 5 cost time: 109.73425221443176
[2024-12-07 14:50:49] [32mIntermediate result: 0.17151093  (Index 4)[0m
Epoch: 5, Steps: 303 | Train Loss: 0.4999137 Vali Loss: 0.4281383 Test Loss: 0.1715109
Validation loss decreased (0.429869 --> 0.428138).  Saving model ...
Updating learning rate to 0.0008090604500762365
	iters: 100, epoch: 6 | loss: 0.6801484
	speed: 0.6035s/iter; left time: 17311.3475s
	iters: 200, epoch: 6 | loss: 0.9199028
	speed: 0.3623s/iter; left time: 10355.4260s
	iters: 300, epoch: 6 | loss: 0.4547801
	speed: 0.3570s/iter; left time: 10170.7046s
Epoch: 6 cost time: 110.26242303848267
[2024-12-07 14:53:02] [32mIntermediate result: 0.17220859  (Index 5)[0m
Epoch: 6, Steps: 303 | Train Loss: 0.4947947 Vali Loss: 0.4192623 Test Loss: 0.1722086
Validation loss decreased (0.428138 --> 0.419262).  Saving model ...
Updating learning rate to 0.0007281544050686128
	iters: 100, epoch: 7 | loss: 0.6413910
	speed: 0.5933s/iter; left time: 16839.0145s
	iters: 200, epoch: 7 | loss: 0.4312052
	speed: 0.3541s/iter; left time: 10014.7308s
	iters: 300, epoch: 7 | loss: 0.3878224
	speed: 0.3514s/iter; left time: 9902.4422s
Epoch: 7 cost time: 107.22836804389954
[2024-12-07 14:55:11] [32mIntermediate result: 0.16975908  (Index 6)[0m
Epoch: 7, Steps: 303 | Train Loss: 0.4888639 Vali Loss: 0.4168901 Test Loss: 0.1697591
Validation loss decreased (0.419262 --> 0.416890).  Saving model ...
Updating learning rate to 0.0006553389645617515
	iters: 100, epoch: 8 | loss: 0.3378629
	speed: 0.5915s/iter; left time: 16609.8251s
	iters: 200, epoch: 8 | loss: 0.6479397
	speed: 0.3727s/iter; left time: 10428.5027s
	iters: 300, epoch: 8 | loss: 0.7633229
	speed: 0.3656s/iter; left time: 10192.5539s
Epoch: 8 cost time: 110.78019142150879
[2024-12-07 14:57:24] [32mIntermediate result: 0.1692081  (Index 7)[0m
Epoch: 8, Steps: 303 | Train Loss: 0.4846629 Vali Loss: 0.4110318 Test Loss: 0.1692081
Validation loss decreased (0.416890 --> 0.411032).  Saving model ...
Updating learning rate to 0.0005898050681055764
	iters: 100, epoch: 9 | loss: 0.4782367
	speed: 0.6079s/iter; left time: 16886.8215s
	iters: 200, epoch: 9 | loss: 0.3961482
	speed: 0.3619s/iter; left time: 10015.7703s
	iters: 300, epoch: 9 | loss: 0.3684289
	speed: 0.3564s/iter; left time: 9828.4477s
Epoch: 9 cost time: 110.28195452690125
[2024-12-07 14:59:37] [32mIntermediate result: 0.16635042  (Index 8)[0m
Epoch: 9, Steps: 303 | Train Loss: 0.4784471 Vali Loss: 0.4097698 Test Loss: 0.1663504
Validation loss decreased (0.411032 --> 0.409770).  Saving model ...
Updating learning rate to 0.0005308245612950188
	iters: 100, epoch: 10 | loss: 0.3417363
	speed: 0.6048s/iter; left time: 16617.2109s
	iters: 200, epoch: 10 | loss: 0.3861911
	speed: 0.3623s/iter; left time: 9917.7076s
	iters: 300, epoch: 10 | loss: 0.6683522
	speed: 0.3464s/iter; left time: 9447.1321s
Epoch: 10 cost time: 108.80931043624878
[2024-12-07 15:01:48] [32mIntermediate result: 0.16667111  (Index 9)[0m
Epoch: 10, Steps: 303 | Train Loss: 0.4764911 Vali Loss: 0.4084688 Test Loss: 0.1666711
Validation loss decreased (0.409770 --> 0.408469).  Saving model ...
Updating learning rate to 0.00047774210516551694
	iters: 100, epoch: 11 | loss: 0.3368405
	speed: 0.5965s/iter; left time: 16207.7042s
	iters: 200, epoch: 11 | loss: 0.3876031
	speed: 0.3631s/iter; left time: 9830.1123s
	iters: 300, epoch: 11 | loss: 0.4225088
	speed: 0.3657s/iter; left time: 9864.4920s
Epoch: 11 cost time: 110.48739433288574
[2024-12-07 15:04:02] [32mIntermediate result: 0.16461153  (Index 10)[0m
Epoch: 11, Steps: 303 | Train Loss: 0.4732826 Vali Loss: 0.4035630 Test Loss: 0.1646115
Validation loss decreased (0.408469 --> 0.403563).  Saving model ...
Updating learning rate to 0.0004299678946489653
	iters: 100, epoch: 12 | loss: 0.3493726
	speed: 0.6008s/iter; left time: 16142.2840s
	iters: 200, epoch: 12 | loss: 0.3422015
	speed: 0.3396s/iter; left time: 9090.4757s
	iters: 300, epoch: 12 | loss: 0.5697479
	speed: 0.3566s/iter; left time: 9508.6970s
Epoch: 12 cost time: 106.46257972717285
[2024-12-07 15:06:11] [32mIntermediate result: 0.16602378  (Index 11)[0m
Epoch: 12, Steps: 303 | Train Loss: 0.4710504 Vali Loss: 0.4069840 Test Loss: 0.1660238
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0003869711051840687
	iters: 100, epoch: 13 | loss: 0.4551691
	speed: 0.5780s/iter; left time: 15353.6452s
	iters: 200, epoch: 13 | loss: 0.4501642
	speed: 0.3452s/iter; left time: 9134.4073s
	iters: 300, epoch: 13 | loss: 0.3689590
	speed: 0.3407s/iter; left time: 8981.2527s
Epoch: 13 cost time: 103.53261756896973
[2024-12-07 15:08:17] [32mIntermediate result: 0.16356783  (Index 12)[0m
Epoch: 13, Steps: 303 | Train Loss: 0.4683392 Vali Loss: 0.4051749 Test Loss: 0.1635678
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00034827399466566186
	iters: 100, epoch: 14 | loss: 0.3597988
	speed: 0.5962s/iter; left time: 15658.4867s
	iters: 200, epoch: 14 | loss: 0.6382210
	speed: 0.3527s/iter; left time: 9228.0507s
	iters: 300, epoch: 14 | loss: 0.4277260
	speed: 0.3517s/iter; left time: 9167.2459s
Epoch: 14 cost time: 107.76037931442261
[2024-12-07 15:10:27] [32mIntermediate result: 0.16215253  (Index 13)[0m
Epoch: 14, Steps: 303 | Train Loss: 0.4674647 Vali Loss: 0.4014353 Test Loss: 0.1621525
Validation loss decreased (0.403563 --> 0.401435).  Saving model ...
Updating learning rate to 0.0003134465951990957
	iters: 100, epoch: 15 | loss: 0.3871745
	speed: 0.6001s/iter; left time: 15578.1577s
	iters: 200, epoch: 15 | loss: 0.4495126
	speed: 0.3480s/iter; left time: 8999.9584s
	iters: 300, epoch: 15 | loss: 0.4324306
	speed: 0.3494s/iter; left time: 9001.1595s
Epoch: 15 cost time: 106.99980115890503
[2024-12-07 15:12:38] [32mIntermediate result: 0.16333921  (Index 14)[0m
Epoch: 15, Steps: 303 | Train Loss: 0.4655650 Vali Loss: 0.4048745 Test Loss: 0.1633392
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00028210193567918614
	iters: 100, epoch: 16 | loss: 0.4098018
	speed: 0.6197s/iter; left time: 15898.7629s
	iters: 200, epoch: 16 | loss: 0.6468148
	speed: 0.3624s/iter; left time: 9262.5962s
	iters: 300, epoch: 16 | loss: 0.3496642
	speed: 0.3396s/iter; left time: 8644.4771s
Epoch: 16 cost time: 108.17458915710449
[2024-12-07 15:14:49] [32mIntermediate result: 0.16264042  (Index 15)[0m
Epoch: 16, Steps: 303 | Train Loss: 0.4642988 Vali Loss: 0.4016135 Test Loss: 0.1626404
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0002538917421112675
	iters: 100, epoch: 17 | loss: 0.4133030
	speed: 0.5797s/iter; left time: 14696.6966s
	iters: 200, epoch: 17 | loss: 0.3207249
	speed: 0.3494s/iter; left time: 8824.5930s
	iters: 300, epoch: 17 | loss: 0.9111254
	speed: 0.3515s/iter; left time: 8841.3954s
Epoch: 17 cost time: 105.96594619750977
[2024-12-07 15:16:57] [32mIntermediate result: 0.16166054  (Index 16)[0m
Epoch: 17, Steps: 303 | Train Loss: 0.4621523 Vali Loss: 0.3972750 Test Loss: 0.1616605
Validation loss decreased (0.401435 --> 0.397275).  Saving model ...
Updating learning rate to 0.0002285025679001408
	iters: 100, epoch: 18 | loss: 0.3906082
	speed: 0.5852s/iter; left time: 14658.5766s
	iters: 200, epoch: 18 | loss: 0.4251954
	speed: 0.3356s/iter; left time: 8373.1796s
	iters: 300, epoch: 18 | loss: 0.4016527
	speed: 0.3351s/iter; left time: 8327.3138s
Epoch: 18 cost time: 103.29694676399231
[2024-12-07 15:19:04] [32mIntermediate result: 0.1616239  (Index 17)[0m
Epoch: 18, Steps: 303 | Train Loss: 0.4620745 Vali Loss: 0.3991976 Test Loss: 0.1616239
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0002056523111101267
	iters: 100, epoch: 19 | loss: 0.3949191
	speed: 0.6047s/iter; left time: 14965.0449s
	iters: 200, epoch: 19 | loss: 0.3452142
	speed: 0.3541s/iter; left time: 8726.8251s
	iters: 300, epoch: 19 | loss: 0.6810319
	speed: 0.3518s/iter; left time: 8634.9551s
Epoch: 19 cost time: 107.8310194015503
[2024-12-07 15:21:14] [32mIntermediate result: 0.16134694  (Index 18)[0m
Epoch: 19, Steps: 303 | Train Loss: 0.4606841 Vali Loss: 0.3999754 Test Loss: 0.1613469
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00018508707999911403
	iters: 100, epoch: 20 | loss: 0.4167643
	speed: 0.5922s/iter; left time: 14475.0242s
	iters: 200, epoch: 20 | loss: 0.4538972
	speed: 0.3507s/iter; left time: 8537.7486s
	iters: 300, epoch: 20 | loss: 0.4080430
	speed: 0.3506s/iter; left time: 8499.9253s
Epoch: 20 cost time: 106.43143510818481
[2024-12-07 15:23:24] [32mIntermediate result: 0.16203658  (Index 19)[0m
Epoch: 20, Steps: 303 | Train Loss: 0.4596186 Vali Loss: 0.3971889 Test Loss: 0.1620366
Validation loss decreased (0.397275 --> 0.397189).  Saving model ...
Updating learning rate to 0.00016657837199920264
	iters: 100, epoch: 21 | loss: 0.3414155
	speed: 0.6005s/iter; left time: 14496.9989s
	iters: 200, epoch: 21 | loss: 0.3542522
	speed: 0.3527s/iter; left time: 8478.9852s
	iters: 300, epoch: 21 | loss: 0.3629184
	speed: 0.3457s/iter; left time: 8276.9377s
Epoch: 21 cost time: 106.22475481033325
[2024-12-07 15:25:34] [32mIntermediate result: 0.1620983  (Index 20)[0m
Epoch: 21, Steps: 303 | Train Loss: 0.4589659 Vali Loss: 0.3954862 Test Loss: 0.1620983
Validation loss decreased (0.397189 --> 0.395486).  Saving model ...
Updating learning rate to 0.00014992053479928236
	iters: 100, epoch: 22 | loss: 0.3183636
	speed: 0.5948s/iter; left time: 14178.8452s
	iters: 200, epoch: 22 | loss: 0.4585674
	speed: 0.3662s/iter; left time: 8693.8684s
	iters: 300, epoch: 22 | loss: 0.3805400
	speed: 0.3612s/iter; left time: 8537.0913s
Epoch: 22 cost time: 109.22410774230957
[2024-12-07 15:27:45] [32mIntermediate result: 0.16126177  (Index 21)[0m
Epoch: 22, Steps: 303 | Train Loss: 0.4576804 Vali Loss: 0.3977228 Test Loss: 0.1612618
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00013492848131935414
	iters: 100, epoch: 23 | loss: 0.4505612
	speed: 0.6047s/iter; left time: 14230.9206s
	iters: 200, epoch: 23 | loss: 0.4100853
	speed: 0.3612s/iter; left time: 8464.3742s
	iters: 300, epoch: 23 | loss: 0.4050395
	speed: 0.3668s/iter; left time: 8559.6503s
Epoch: 23 cost time: 111.15829348564148
[2024-12-07 15:29:58] [32mIntermediate result: 0.1606564  (Index 22)[0m
Epoch: 23, Steps: 303 | Train Loss: 0.4576579 Vali Loss: 0.3968719 Test Loss: 0.1606564
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00012143563318741874
	iters: 100, epoch: 24 | loss: 0.3732516
	speed: 0.5993s/iter; left time: 13922.8274s
	iters: 200, epoch: 24 | loss: 0.3441272
	speed: 0.3723s/iter; left time: 8611.2538s
	iters: 300, epoch: 24 | loss: 0.3531366
	speed: 0.3667s/iter; left time: 8446.0692s
Epoch: 24 cost time: 111.79523658752441
[2024-12-07 15:32:12] [32mIntermediate result: 0.16023716  (Index 23)[0m
Epoch: 24, Steps: 303 | Train Loss: 0.4560452 Vali Loss: 0.3977719 Test Loss: 0.1602372
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.00010929206986867687
	iters: 100, epoch: 25 | loss: 0.3321049
	speed: 0.6065s/iter; left time: 13905.7022s
	iters: 200, epoch: 25 | loss: 0.3986254
	speed: 0.3637s/iter; left time: 8303.9885s
	iters: 300, epoch: 25 | loss: 0.3233514
	speed: 0.3734s/iter; left time: 8487.7633s
Epoch: 25 cost time: 112.36892557144165
[2024-12-07 15:34:26] [32mIntermediate result: 0.16214623  (Index 24)[0m
Epoch: 25, Steps: 303 | Train Loss: 0.4561105 Vali Loss: 0.3986675 Test Loss: 0.1621462
EarlyStopping counter: 4 out of 8
Updating learning rate to 9.836286288180918e-05
	iters: 100, epoch: 26 | loss: 0.3347940
	speed: 0.6037s/iter; left time: 13658.8985s
	iters: 200, epoch: 26 | loss: 0.3871573
	speed: 0.3499s/iter; left time: 7882.4996s
	iters: 300, epoch: 26 | loss: 0.3447379
	speed: 0.3408s/iter; left time: 7642.2733s
Epoch: 26 cost time: 107.33410692214966
[2024-12-07 15:36:36] [32mIntermediate result: 0.16031756  (Index 25)[0m
Epoch: 26, Steps: 303 | Train Loss: 0.4558525 Vali Loss: 0.3938358 Test Loss: 0.1603176
Validation loss decreased (0.395486 --> 0.393836).  Saving model ...
Updating learning rate to 8.852657659362827e-05
	iters: 100, epoch: 27 | loss: 0.6210076
	speed: 0.5815s/iter; left time: 12980.0138s
	iters: 200, epoch: 27 | loss: 0.3543288
	speed: 0.3532s/iter; left time: 7850.1585s
	iters: 300, epoch: 27 | loss: 0.3366428
	speed: 0.3649s/iter; left time: 8072.2503s
Epoch: 27 cost time: 107.98144102096558
[2024-12-07 15:38:46] [32mIntermediate result: 0.16028714  (Index 26)[0m
Epoch: 27, Steps: 303 | Train Loss: 0.4547658 Vali Loss: 0.3965659 Test Loss: 0.1602871
EarlyStopping counter: 1 out of 8
Updating learning rate to 7.967391893426544e-05
	iters: 100, epoch: 28 | loss: 0.5779230
	speed: 0.6033s/iter; left time: 13285.4059s
	iters: 200, epoch: 28 | loss: 0.3904792
	speed: 0.3448s/iter; left time: 7558.0097s
	iters: 300, epoch: 28 | loss: 0.4107585
	speed: 0.3410s/iter; left time: 7439.7412s
Epoch: 28 cost time: 106.57315444946289
[2024-12-07 15:40:55] [32mIntermediate result: 0.16054018  (Index 27)[0m
Epoch: 28, Steps: 303 | Train Loss: 0.4543256 Vali Loss: 0.3979930 Test Loss: 0.1605402
EarlyStopping counter: 2 out of 8
Updating learning rate to 7.170652704083889e-05
	iters: 100, epoch: 29 | loss: 0.6827364
	speed: 0.5889s/iter; left time: 12788.0904s
	iters: 200, epoch: 29 | loss: 0.4116215
	speed: 0.3455s/iter; left time: 7469.4850s
	iters: 300, epoch: 29 | loss: 0.3608418
	speed: 0.3438s/iter; left time: 7398.4577s
Epoch: 29 cost time: 105.50411987304688
[2024-12-07 15:43:02] [32mIntermediate result: 0.1610204  (Index 28)[0m
Epoch: 29, Steps: 303 | Train Loss: 0.4542518 Vali Loss: 0.3947772 Test Loss: 0.1610204
EarlyStopping counter: 3 out of 8
Updating learning rate to 6.4535874336755e-05
	iters: 100, epoch: 30 | loss: 0.5518798
	speed: 0.5840s/iter; left time: 12505.6451s
	iters: 200, epoch: 30 | loss: 0.6421699
	speed: 0.3498s/iter; left time: 7456.0960s
	iters: 300, epoch: 30 | loss: 0.3970474
	speed: 0.3511s/iter; left time: 7448.8798s
Epoch: 30 cost time: 106.57811450958252
[2024-12-07 15:45:11] [32mIntermediate result: 0.15992372  (Index 29)[0m
Epoch: 30, Steps: 303 | Train Loss: 0.4538582 Vali Loss: 0.3961609 Test Loss: 0.1599237
EarlyStopping counter: 4 out of 8
Updating learning rate to 5.8082286903079504e-05
	iters: 100, epoch: 31 | loss: 0.3474258
	speed: 0.5800s/iter; left time: 12245.1760s
	iters: 200, epoch: 31 | loss: 0.3491782
	speed: 0.3519s/iter; left time: 7394.4317s
	iters: 300, epoch: 31 | loss: 0.6192659
	speed: 0.3525s/iter; left time: 7370.7563s
Epoch: 31 cost time: 105.95084023475647
[2024-12-07 15:47:21] [32mIntermediate result: 0.16017012  (Index 30)[0m
Epoch: 31, Steps: 303 | Train Loss: 0.4534807 Vali Loss: 0.3952084 Test Loss: 0.1601701
EarlyStopping counter: 5 out of 8
Updating learning rate to 5.227405821277156e-05
	iters: 100, epoch: 32 | loss: 0.3316853
	speed: 0.5900s/iter; left time: 12276.2216s
	iters: 200, epoch: 32 | loss: 0.8684022
	speed: 0.3449s/iter; left time: 7143.1119s
	iters: 300, epoch: 32 | loss: 0.8346297
	speed: 0.3695s/iter; left time: 7613.7764s
Epoch: 32 cost time: 106.90577721595764
[2024-12-07 15:49:30] [32mIntermediate result: 0.15930186  (Index 31)[0m
Epoch: 32, Steps: 303 | Train Loss: 0.4532643 Vali Loss: 0.3964229 Test Loss: 0.1593019
EarlyStopping counter: 6 out of 8
Updating learning rate to 4.704665239149441e-05
	iters: 100, epoch: 33 | loss: 0.3694465
	speed: 0.5886s/iter; left time: 12068.7673s
	iters: 200, epoch: 33 | loss: 0.4158095
	speed: 0.3601s/iter; left time: 7348.4513s
	iters: 300, epoch: 33 | loss: 0.4082042
	speed: 0.3654s/iter; left time: 7419.5457s
Epoch: 33 cost time: 109.57463836669922
[2024-12-07 15:51:41] [32mIntermediate result: 0.16087463  (Index 32)[0m
Epoch: 33, Steps: 303 | Train Loss: 0.4529850 Vali Loss: 0.3969632 Test Loss: 0.1608746
EarlyStopping counter: 7 out of 8
Updating learning rate to 4.234198715234497e-05
	iters: 100, epoch: 34 | loss: 0.3550128
	speed: 0.5897s/iter; left time: 11913.1017s
	iters: 200, epoch: 34 | loss: 0.4254728
	speed: 0.3197s/iter; left time: 6426.6722s
	iters: 300, epoch: 34 | loss: 0.3772601
	speed: 0.3188s/iter; left time: 6376.3735s
Epoch: 34 cost time: 100.55613493919373
[2024-12-07 15:53:44] [32mIntermediate result: 0.16028418  (Index 33)[0m
Epoch: 34, Steps: 303 | Train Loss: 0.4528716 Vali Loss: 0.3961326 Test Loss: 0.1602842
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 65_1_1_96_96_MGSformer_TST_custom_ftM_sl96_ll18_pl96_dm45_nh9_el8_dl1_df160_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.1603177934885025, mae:0.2082122266292572, rse:0.5275052189826965
[2024-12-07 15:54:01] [32mFinal result: 0.1603178[0m
