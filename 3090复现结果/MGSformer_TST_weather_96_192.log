Args in experiment:
Namespace(accumulation_steps=8, activation='gelu', affine=0, batch_size=121, c_out=7, checkpoints='./checkpoints/', compress_len=10, d_ff=160, d_layers=1, d_model=128, data='custom', data_path='weather.csv', dec_in=7, decomposition=0, des='Exp', device_ids=[0, 1, 2], devices='0,1,2', distil=True, do_predict=False, dropout=0.28801281872508566, dvices='0,1,2', e_layers=8, embed='timeF', embed_type=0, enc_in=21, factor=1, fc_dropout=0.31935425281318547, features='M', freq='h', gpu=0, head_dropout=0.23228521905588617, individual=0, is_training=1, itr=1, kernel_size=25, label_len=18, learning_rate=0.000998840061822514, loss='mse', lradj='type3', model='MGSformer_TST', model_id='96_192', momentum=0.9758700119546663, moving_avg=25, n=1, n_heads=9, n_intra=1, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.3, period=65, pred_len=192, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=True, x=5)
Use GPU: cuda:0
>>>>>>>start training : 65_1_1_96_192_MGSformer_TST_custom_ftM_sl96_ll18_pl192_dm45_nh9_el8_dl1_df160_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
module.model.backbone.W_pos_intra: 90
module.model.backbone.W_pos: 2925
module.model.backbone.W_pos_coarse: 945
module.model.backbone.W_P_intra.weight: 5850
module.model.backbone.W_P_intra.bias: 45
module.model.backbone.W_P.weight: 2925
module.model.backbone.W_P.bias: 45
module.model.backbone.W_P_coarse.weight: 9450
module.model.backbone.W_P_coarse.bias: 45
module.model.backbone.encoder.layers.0.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.0.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.0.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.0.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.0.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.0.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.0.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.0.ff.0.weight: 7200
module.model.backbone.encoder.layers.0.ff.0.bias: 160
module.model.backbone.encoder.layers.0.ff.3.weight: 7200
module.model.backbone.encoder.layers.0.ff.3.bias: 45
module.model.backbone.encoder.layers.0.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.0.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.1.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.1.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.1.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.1.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.1.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.1.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.1.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.1.ff.0.weight: 7200
module.model.backbone.encoder.layers.1.ff.0.bias: 160
module.model.backbone.encoder.layers.1.ff.3.weight: 7200
module.model.backbone.encoder.layers.1.ff.3.bias: 45
module.model.backbone.encoder.layers.1.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.1.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.2.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.2.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.2.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.2.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.2.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.2.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.2.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.2.ff.0.weight: 7200
module.model.backbone.encoder.layers.2.ff.0.bias: 160
module.model.backbone.encoder.layers.2.ff.3.weight: 7200
module.model.backbone.encoder.layers.2.ff.3.bias: 45
module.model.backbone.encoder.layers.2.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.2.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.3.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.3.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.3.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.3.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.3.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.3.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.3.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.3.ff.0.weight: 7200
module.model.backbone.encoder.layers.3.ff.0.bias: 160
module.model.backbone.encoder.layers.3.ff.3.weight: 7200
module.model.backbone.encoder.layers.3.ff.3.bias: 45
module.model.backbone.encoder.layers.3.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.3.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.4.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.4.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.4.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.4.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.4.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.4.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.4.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.4.ff.0.weight: 7200
module.model.backbone.encoder.layers.4.ff.0.bias: 160
module.model.backbone.encoder.layers.4.ff.3.weight: 7200
module.model.backbone.encoder.layers.4.ff.3.bias: 45
module.model.backbone.encoder.layers.4.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.4.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.5.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.5.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.5.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.5.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.5.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.5.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.5.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.5.ff.0.weight: 7200
module.model.backbone.encoder.layers.5.ff.0.bias: 160
module.model.backbone.encoder.layers.5.ff.3.weight: 7200
module.model.backbone.encoder.layers.5.ff.3.bias: 45
module.model.backbone.encoder.layers.5.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.5.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.6.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.6.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.6.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.6.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.6.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.6.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.6.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.6.ff.0.weight: 7200
module.model.backbone.encoder.layers.6.ff.0.bias: 160
module.model.backbone.encoder.layers.6.ff.3.weight: 7200
module.model.backbone.encoder.layers.6.ff.3.bias: 45
module.model.backbone.encoder.layers.6.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.6.norm_ffn.1.bias: 45
module.model.backbone.encoder.layers.7.self_attn.W_Q.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.W_Q.bias: 45
module.model.backbone.encoder.layers.7.self_attn.W_K.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.W_K.bias: 45
module.model.backbone.encoder.layers.7.self_attn.W_V.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.W_V.bias: 45
module.model.backbone.encoder.layers.7.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder.layers.7.self_attn.to_out.0.bias: 45
module.model.backbone.encoder.layers.7.norm_attn.1.weight: 45
module.model.backbone.encoder.layers.7.norm_attn.1.bias: 45
module.model.backbone.encoder.layers.7.ff.0.weight: 7200
module.model.backbone.encoder.layers.7.ff.0.bias: 160
module.model.backbone.encoder.layers.7.ff.3.weight: 7200
module.model.backbone.encoder.layers.7.ff.3.bias: 45
module.model.backbone.encoder.layers.7.norm_ffn.1.weight: 45
module.model.backbone.encoder.layers.7.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.0.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.0.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.0.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.0.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.0.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.0.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.1.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.1.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.1.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.1.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.1.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.1.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.1.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.1.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.2.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.2.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.2.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.2.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.2.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.2.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.2.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.2.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.3.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.3.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.3.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.3.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.3.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.3.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.3.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.3.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.3.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.3.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.4.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.4.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.4.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.4.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.4.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.4.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.4.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.4.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.4.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.4.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.5.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.5.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.5.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.5.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.5.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.5.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.5.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.5.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.5.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.5.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.6.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.6.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.6.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.6.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.6.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.6.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.6.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.6.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.6.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.6.norm_ffn.1.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.W_Q.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.W_K.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.W_K.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.W_V.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.W_V.bias: 45
module.model.backbone.encoder_intra.layers.7.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_intra.layers.7.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_intra.layers.7.norm_attn.1.weight: 45
module.model.backbone.encoder_intra.layers.7.norm_attn.1.bias: 45
module.model.backbone.encoder_intra.layers.7.ff.0.weight: 7200
module.model.backbone.encoder_intra.layers.7.ff.0.bias: 160
module.model.backbone.encoder_intra.layers.7.ff.3.weight: 7200
module.model.backbone.encoder_intra.layers.7.ff.3.bias: 45
module.model.backbone.encoder_intra.layers.7.norm_ffn.1.weight: 45
module.model.backbone.encoder_intra.layers.7.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.0.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.0.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.0.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.0.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.1.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.1.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.1.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.1.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.1.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.1.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.1.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.2.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.2.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.2.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.2.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.2.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.2.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.2.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.3.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.3.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.3.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.3.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.3.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.3.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.3.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.3.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.3.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.3.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.4.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.4.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.4.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.4.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.4.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.4.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.4.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.4.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.4.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.4.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.5.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.5.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.5.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.5.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.5.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.5.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.5.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.5.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.5.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.5.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.6.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.6.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.6.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.6.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.6.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.6.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.6.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.6.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.6.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.6.norm_ffn.1.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.W_Q.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.W_Q.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.W_K.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.W_K.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.W_V.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.W_V.bias: 45
module.model.backbone.encoder_coarse.layers.7.self_attn.to_out.0.weight: 2025
module.model.backbone.encoder_coarse.layers.7.self_attn.to_out.0.bias: 45
module.model.backbone.encoder_coarse.layers.7.norm_attn.1.weight: 45
module.model.backbone.encoder_coarse.layers.7.norm_attn.1.bias: 45
module.model.backbone.encoder_coarse.layers.7.ff.0.weight: 7200
module.model.backbone.encoder_coarse.layers.7.ff.0.bias: 160
module.model.backbone.encoder_coarse.layers.7.ff.3.weight: 7200
module.model.backbone.encoder_coarse.layers.7.ff.3.bias: 45
module.model.backbone.encoder_coarse.layers.7.norm_ffn.1.weight: 45
module.model.backbone.encoder_coarse.layers.7.norm_ffn.1.bias: 45
module.model.head.linear.weight: 1149120
module.model.head.linear.bias: 192
module.model.compress.weight: 960
module.model.compress.bias: 10
Total trainable parameters: 1726162
train 36600
val 5079
test 10348
	iters: 100, epoch: 1 | loss: 0.8243952
	speed: 0.3740s/iter; left time: 11256.3367s
	iters: 200, epoch: 1 | loss: 0.6307700
	speed: 0.3479s/iter; left time: 10437.6716s
	iters: 300, epoch: 1 | loss: 0.5871322
	speed: 0.3421s/iter; left time: 10230.5523s
Epoch: 1 cost time: 106.57995343208313
[2024-12-07 15:56:15] [32mIntermediate result: 0.24551351  (Index 0)[0m
Epoch: 1, Steps: 302 | Train Loss: 0.7763272 Vali Loss: 0.5756059 Test Loss: 0.2455135
Validation loss decreased (inf --> 0.575606).  Saving model ...
Updating learning rate to 0.000998840061822514
	iters: 100, epoch: 2 | loss: 0.6758745
	speed: 0.5762s/iter; left time: 17170.2313s
	iters: 200, epoch: 2 | loss: 1.1659162
	speed: 0.3465s/iter; left time: 10289.6929s
	iters: 300, epoch: 2 | loss: 0.7091140
	speed: 0.3413s/iter; left time: 10101.7074s
Epoch: 2 cost time: 104.44532704353333
[2024-12-07 15:58:22] [32mIntermediate result: 0.2364092  (Index 1)[0m
Epoch: 2, Steps: 302 | Train Loss: 0.6580547 Vali Loss: 0.5442709 Test Loss: 0.2364092
Validation loss decreased (0.575606 --> 0.544271).  Saving model ...
Updating learning rate to 0.000998840061822514
	iters: 100, epoch: 3 | loss: 0.4743324
	speed: 0.5581s/iter; left time: 16463.4394s
	iters: 200, epoch: 3 | loss: 0.5868583
	speed: 0.3242s/iter; left time: 9530.8635s
	iters: 300, epoch: 3 | loss: 0.5410262
	speed: 0.3264s/iter; left time: 9562.6786s
Epoch: 3 cost time: 98.47327184677124
[2024-12-07 16:00:23] [32mIntermediate result: 0.22538248  (Index 2)[0m
Epoch: 3, Steps: 302 | Train Loss: 0.5899916 Vali Loss: 0.5086786 Test Loss: 0.2253825
Validation loss decreased (0.544271 --> 0.508679).  Saving model ...
Updating learning rate to 0.000998840061822514
	iters: 100, epoch: 4 | loss: 0.6541216
	speed: 0.5949s/iter; left time: 17368.8866s
	iters: 200, epoch: 4 | loss: 0.6563463
	speed: 0.3441s/iter; left time: 10011.3947s
	iters: 300, epoch: 4 | loss: 0.5998047
	speed: 0.3404s/iter; left time: 9869.0813s
Epoch: 4 cost time: 105.57804107666016
[2024-12-07 16:02:30] [32mIntermediate result: 0.22107422  (Index 3)[0m
Epoch: 4, Steps: 302 | Train Loss: 0.5692784 Vali Loss: 0.4995902 Test Loss: 0.2210742
Validation loss decreased (0.508679 --> 0.499590).  Saving model ...
Updating learning rate to 0.0008989560556402627
	iters: 100, epoch: 5 | loss: 0.4819007
	speed: 0.5709s/iter; left time: 16495.6744s
	iters: 200, epoch: 5 | loss: 0.4904230
	speed: 0.3360s/iter; left time: 9674.6462s
	iters: 300, epoch: 5 | loss: 0.5056809
	speed: 0.3418s/iter; left time: 9805.9157s
Epoch: 5 cost time: 102.7687246799469
[2024-12-07 16:04:36] [32mIntermediate result: 0.22056073  (Index 4)[0m
Epoch: 5, Steps: 302 | Train Loss: 0.5630776 Vali Loss: 0.4915313 Test Loss: 0.2205607
Validation loss decreased (0.499590 --> 0.491531).  Saving model ...
Updating learning rate to 0.0008090604500762365
	iters: 100, epoch: 6 | loss: 0.4241772
	speed: 0.5712s/iter; left time: 16332.5701s
	iters: 200, epoch: 6 | loss: 0.4665897
	speed: 0.3391s/iter; left time: 9662.3217s
	iters: 300, epoch: 6 | loss: 0.5411578
	speed: 0.3351s/iter; left time: 9513.4898s
Epoch: 6 cost time: 102.18065047264099
[2024-12-07 16:06:41] [32mIntermediate result: 0.22027478  (Index 5)[0m
Epoch: 6, Steps: 302 | Train Loss: 0.5565719 Vali Loss: 0.4917091 Test Loss: 0.2202748
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0007281544050686128
	iters: 100, epoch: 7 | loss: 0.4783270
	speed: 0.5782s/iter; left time: 16357.1464s
	iters: 200, epoch: 7 | loss: 0.4378934
	speed: 0.3459s/iter; left time: 9750.7033s
	iters: 300, epoch: 7 | loss: 0.4288039
	speed: 0.3476s/iter; left time: 9763.1909s
Epoch: 7 cost time: 104.28192687034607
[2024-12-07 16:08:47] [32mIntermediate result: 0.21455535  (Index 6)[0m
Epoch: 7, Steps: 302 | Train Loss: 0.5500700 Vali Loss: 0.4844336 Test Loss: 0.2145554
Validation loss decreased (0.491531 --> 0.484434).  Saving model ...
Updating learning rate to 0.0006553389645617515
	iters: 100, epoch: 8 | loss: 0.6586774
	speed: 0.5747s/iter; left time: 16084.0100s
	iters: 200, epoch: 8 | loss: 0.4696212
	speed: 0.3408s/iter; left time: 9503.0763s
	iters: 300, epoch: 8 | loss: 0.6130034
	speed: 0.3506s/iter; left time: 9743.4260s
Epoch: 8 cost time: 104.59549403190613
[2024-12-07 16:10:54] [32mIntermediate result: 0.21427935  (Index 7)[0m
Epoch: 8, Steps: 302 | Train Loss: 0.5470484 Vali Loss: 0.4795777 Test Loss: 0.2142794
Validation loss decreased (0.484434 --> 0.479578).  Saving model ...
Updating learning rate to 0.0005898050681055764
	iters: 100, epoch: 9 | loss: 0.4386924
	speed: 0.5994s/iter; left time: 16594.9029s
	iters: 200, epoch: 9 | loss: 0.5353170
	speed: 0.3334s/iter; left time: 9197.9216s
	iters: 300, epoch: 9 | loss: 0.4431453
	speed: 0.3501s/iter; left time: 9622.2606s
Epoch: 9 cost time: 105.51147294044495
[2024-12-07 16:13:02] [32mIntermediate result: 0.21215664  (Index 8)[0m
Epoch: 9, Steps: 302 | Train Loss: 0.5409425 Vali Loss: 0.4793243 Test Loss: 0.2121566
Validation loss decreased (0.479578 --> 0.479324).  Saving model ...
Updating learning rate to 0.0005308245612950188
	iters: 100, epoch: 10 | loss: 0.4672871
	speed: 0.5763s/iter; left time: 15780.3994s
	iters: 200, epoch: 10 | loss: 0.4441285
	speed: 0.3454s/iter; left time: 9422.5072s
	iters: 300, epoch: 10 | loss: 0.5801318
	speed: 0.3454s/iter; left time: 9389.0560s
Epoch: 10 cost time: 104.47811245918274
[2024-12-07 16:15:10] [32mIntermediate result: 0.21175078  (Index 9)[0m
Epoch: 10, Steps: 302 | Train Loss: 0.5385878 Vali Loss: 0.4776333 Test Loss: 0.2117508
Validation loss decreased (0.479324 --> 0.477633).  Saving model ...
Updating learning rate to 0.00047774210516551694
	iters: 100, epoch: 11 | loss: 0.5913749
	speed: 0.5920s/iter; left time: 16031.4731s
	iters: 200, epoch: 11 | loss: 0.4784876
	speed: 0.3424s/iter; left time: 9237.8029s
	iters: 300, epoch: 11 | loss: 0.5903910
	speed: 0.3261s/iter; left time: 8766.8737s
Epoch: 11 cost time: 102.6450207233429
[2024-12-07 16:17:16] [32mIntermediate result: 0.2120296  (Index 10)[0m
Epoch: 11, Steps: 302 | Train Loss: 0.5367755 Vali Loss: 0.4784408 Test Loss: 0.2120296
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0004299678946489653
	iters: 100, epoch: 12 | loss: 0.4505835
	speed: 0.5530s/iter; left time: 14809.9744s
	iters: 200, epoch: 12 | loss: 0.5566788
	speed: 0.3133s/iter; left time: 8359.3263s
	iters: 300, epoch: 12 | loss: 0.5746433
	speed: 0.3331s/iter; left time: 8852.2582s
Epoch: 12 cost time: 96.9092948436737
[2024-12-07 16:19:15] [32mIntermediate result: 0.20917112  (Index 11)[0m
Epoch: 12, Steps: 302 | Train Loss: 0.5327520 Vali Loss: 0.4717052 Test Loss: 0.2091711
Validation loss decreased (0.477633 --> 0.471705).  Saving model ...
Updating learning rate to 0.0003869711051840687
	iters: 100, epoch: 13 | loss: 0.5842410
	speed: 0.5847s/iter; left time: 15480.2280s
	iters: 200, epoch: 13 | loss: 0.7132916
	speed: 0.3462s/iter; left time: 9132.8480s
	iters: 300, epoch: 13 | loss: 0.6595871
	speed: 0.3497s/iter; left time: 9188.1618s
Epoch: 13 cost time: 105.31783771514893
[2024-12-07 16:21:23] [32mIntermediate result: 0.20995241  (Index 12)[0m
Epoch: 13, Steps: 302 | Train Loss: 0.5300167 Vali Loss: 0.4758317 Test Loss: 0.2099524
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00034827399466566186
	iters: 100, epoch: 14 | loss: 0.4430066
	speed: 0.5761s/iter; left time: 15078.8126s
	iters: 200, epoch: 14 | loss: 0.5759641
	speed: 0.3464s/iter; left time: 9031.1576s
	iters: 300, epoch: 14 | loss: 0.6032795
	speed: 0.3444s/iter; left time: 8947.0053s
Epoch: 14 cost time: 104.52536487579346
[2024-12-07 16:23:30] [32mIntermediate result: 0.20819783  (Index 13)[0m
Epoch: 14, Steps: 302 | Train Loss: 0.5284848 Vali Loss: 0.4672679 Test Loss: 0.2081978
Validation loss decreased (0.471705 --> 0.467268).  Saving model ...
Updating learning rate to 0.0003134465951990957
	iters: 100, epoch: 15 | loss: 0.5529583
	speed: 0.5787s/iter; left time: 14972.6956s
	iters: 200, epoch: 15 | loss: 0.4369690
	speed: 0.3375s/iter; left time: 8699.4461s
	iters: 300, epoch: 15 | loss: 0.8348026
	speed: 0.3350s/iter; left time: 8599.2021s
Epoch: 15 cost time: 102.16365480422974
[2024-12-07 16:25:35] [32mIntermediate result: 0.20900159  (Index 14)[0m
Epoch: 15, Steps: 302 | Train Loss: 0.5269590 Vali Loss: 0.4709552 Test Loss: 0.2090016
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00028210193567918614
	iters: 100, epoch: 16 | loss: 0.4988979
	speed: 0.5880s/iter; left time: 15035.2617s
	iters: 200, epoch: 16 | loss: 0.4291483
	speed: 0.3552s/iter; left time: 9046.1221s
	iters: 300, epoch: 16 | loss: 0.9170166
	speed: 0.3509s/iter; left time: 8901.8218s
Epoch: 16 cost time: 107.00982451438904
[2024-12-07 16:27:45] [32mIntermediate result: 0.20774132  (Index 15)[0m
Epoch: 16, Steps: 302 | Train Loss: 0.5249828 Vali Loss: 0.4698315 Test Loss: 0.2077413
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0002538917421112675
	iters: 100, epoch: 17 | loss: 0.5893950
	speed: 0.5879s/iter; left time: 14854.7405s
	iters: 200, epoch: 17 | loss: 0.4499180
	speed: 0.3437s/iter; left time: 8650.0568s
	iters: 300, epoch: 17 | loss: 0.6626692
	speed: 0.3589s/iter; left time: 8997.2986s
Epoch: 17 cost time: 105.69984292984009
[2024-12-07 16:29:53] [32mIntermediate result: 0.2080557  (Index 16)[0m
Epoch: 17, Steps: 302 | Train Loss: 0.5233254 Vali Loss: 0.4693745 Test Loss: 0.2080557
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.0002285025679001408
	iters: 100, epoch: 18 | loss: 0.4790054
	speed: 0.5815s/iter; left time: 14517.2486s
	iters: 200, epoch: 18 | loss: 0.4251309
	speed: 0.3341s/iter; left time: 8308.8095s
	iters: 300, epoch: 18 | loss: 0.4236261
	speed: 0.3377s/iter; left time: 8364.4847s
Epoch: 18 cost time: 103.48097467422485
[2024-12-07 16:31:59] [32mIntermediate result: 0.20817153  (Index 17)[0m
Epoch: 18, Steps: 302 | Train Loss: 0.5224310 Vali Loss: 0.4679269 Test Loss: 0.2081715
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.0002056523111101267
	iters: 100, epoch: 19 | loss: 0.3908442
	speed: 0.5726s/iter; left time: 14122.2786s
	iters: 200, epoch: 19 | loss: 0.5889214
	speed: 0.3299s/iter; left time: 8103.6189s
	iters: 300, epoch: 19 | loss: 0.5923332
	speed: 0.3369s/iter; left time: 8241.2065s
Epoch: 19 cost time: 101.44489312171936
[2024-12-07 16:34:03] [32mIntermediate result: 0.20646405  (Index 18)[0m
Epoch: 19, Steps: 302 | Train Loss: 0.5216393 Vali Loss: 0.4698841 Test Loss: 0.2064641
EarlyStopping counter: 5 out of 8
Updating learning rate to 0.00018508707999911403
	iters: 100, epoch: 20 | loss: 0.5084786
	speed: 0.5854s/iter; left time: 14262.4414s
	iters: 200, epoch: 20 | loss: 0.4485874
	speed: 0.3531s/iter; left time: 8567.9663s
	iters: 300, epoch: 20 | loss: 0.5857190
	speed: 0.3486s/iter; left time: 8422.2523s
Epoch: 20 cost time: 106.30026030540466
[2024-12-07 16:36:12] [32mIntermediate result: 0.20784196  (Index 19)[0m
Epoch: 20, Steps: 302 | Train Loss: 0.5203023 Vali Loss: 0.4668848 Test Loss: 0.2078420
Validation loss decreased (0.467268 --> 0.466885).  Saving model ...
Updating learning rate to 0.00016657837199920264
	iters: 100, epoch: 21 | loss: 0.5278993
	speed: 0.6014s/iter; left time: 14470.6823s
	iters: 200, epoch: 21 | loss: 0.3918437
	speed: 0.3365s/iter; left time: 8062.8092s
	iters: 300, epoch: 21 | loss: 0.5094947
	speed: 0.3252s/iter; left time: 7760.6424s
Epoch: 21 cost time: 103.43722581863403
[2024-12-07 16:38:18] [32mIntermediate result: 0.2069338  (Index 20)[0m
Epoch: 21, Steps: 302 | Train Loss: 0.5190601 Vali Loss: 0.4680012 Test Loss: 0.2069338
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.00014992053479928236
	iters: 100, epoch: 22 | loss: 0.7556711
	speed: 0.5807s/iter; left time: 13796.0232s
	iters: 200, epoch: 22 | loss: 0.5189238
	speed: 0.3440s/iter; left time: 8138.7793s
	iters: 300, epoch: 22 | loss: 0.7092431
	speed: 0.3398s/iter; left time: 8005.2816s
Epoch: 22 cost time: 103.79128170013428
[2024-12-07 16:40:25] [32mIntermediate result: 0.20777264  (Index 21)[0m
Epoch: 22, Steps: 302 | Train Loss: 0.5182721 Vali Loss: 0.4677242 Test Loss: 0.2077726
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.00013492848131935414
	iters: 100, epoch: 23 | loss: 0.4967470
	speed: 0.5941s/iter; left time: 13936.7842s
	iters: 200, epoch: 23 | loss: 0.5713003
	speed: 0.3496s/iter; left time: 8164.4924s
	iters: 300, epoch: 23 | loss: 0.4223619
	speed: 0.3332s/iter; left time: 7748.4756s
Epoch: 23 cost time: 104.58017659187317
[2024-12-07 16:42:32] [32mIntermediate result: 0.20716584  (Index 22)[0m
Epoch: 23, Steps: 302 | Train Loss: 0.5173207 Vali Loss: 0.4688971 Test Loss: 0.2071658
EarlyStopping counter: 3 out of 8
Updating learning rate to 0.00012143563318741874
	iters: 100, epoch: 24 | loss: 0.4234160
	speed: 0.5827s/iter; left time: 13493.0697s
	iters: 200, epoch: 24 | loss: 0.4026861
	speed: 0.3472s/iter; left time: 8004.8940s
	iters: 300, epoch: 24 | loss: 0.5672243
	speed: 0.3455s/iter; left time: 7930.8813s
Epoch: 24 cost time: 105.24232482910156
[2024-12-07 16:44:39] [32mIntermediate result: 0.20689166  (Index 23)[0m
Epoch: 24, Steps: 302 | Train Loss: 0.5158266 Vali Loss: 0.4677952 Test Loss: 0.2068917
EarlyStopping counter: 4 out of 8
Updating learning rate to 0.00010929206986867687
	iters: 100, epoch: 25 | loss: 0.5506162
	speed: 0.5880s/iter; left time: 13437.8460s
	iters: 200, epoch: 25 | loss: 0.4066365
	speed: 0.3538s/iter; left time: 8050.4689s
	iters: 300, epoch: 25 | loss: 0.4866287
	speed: 0.3518s/iter; left time: 7969.4035s
Epoch: 25 cost time: 106.82197403907776
[2024-12-07 16:46:49] [32mIntermediate result: 0.20715673  (Index 24)[0m
Epoch: 25, Steps: 302 | Train Loss: 0.5162917 Vali Loss: 0.4683811 Test Loss: 0.2071567
EarlyStopping counter: 5 out of 8
Updating learning rate to 9.836286288180918e-05
	iters: 100, epoch: 26 | loss: 0.4342004
	speed: 0.5847s/iter; left time: 13186.2180s
	iters: 200, epoch: 26 | loss: 0.5046793
	speed: 0.3519s/iter; left time: 7900.0844s
	iters: 300, epoch: 26 | loss: 0.4509311
	speed: 0.3508s/iter; left time: 7840.7118s
Epoch: 26 cost time: 106.27891945838928
[2024-12-07 16:48:57] [32mIntermediate result: 0.20649813  (Index 25)[0m
Epoch: 26, Steps: 302 | Train Loss: 0.5157277 Vali Loss: 0.4695252 Test Loss: 0.2064981
EarlyStopping counter: 6 out of 8
Updating learning rate to 8.852657659362827e-05
	iters: 100, epoch: 27 | loss: 0.5246475
	speed: 0.5569s/iter; left time: 12390.5921s
	iters: 200, epoch: 27 | loss: 0.6973110
	speed: 0.3502s/iter; left time: 7755.8007s
	iters: 300, epoch: 27 | loss: 0.4479946
	speed: 0.3386s/iter; left time: 7466.4655s
Epoch: 27 cost time: 102.4683747291565
[2024-12-07 16:51:02] [32mIntermediate result: 0.20697746  (Index 26)[0m
Epoch: 27, Steps: 302 | Train Loss: 0.5149187 Vali Loss: 0.4660115 Test Loss: 0.2069775
Validation loss decreased (0.466885 --> 0.466011).  Saving model ...
Updating learning rate to 7.967391893426544e-05
	iters: 100, epoch: 28 | loss: 0.7057271
	speed: 0.5779s/iter; left time: 12682.1978s
	iters: 200, epoch: 28 | loss: 0.4804978
	speed: 0.3430s/iter; left time: 7494.4147s
	iters: 300, epoch: 28 | loss: 0.5654788
	speed: 0.3492s/iter; left time: 7593.3508s
Epoch: 28 cost time: 104.77990317344666
[2024-12-07 16:53:09] [32mIntermediate result: 0.20676574  (Index 27)[0m
Epoch: 28, Steps: 302 | Train Loss: 0.5138751 Vali Loss: 0.4682205 Test Loss: 0.2067657
EarlyStopping counter: 1 out of 8
Updating learning rate to 7.170652704083889e-05
	iters: 100, epoch: 29 | loss: 0.6386832
	speed: 0.5935s/iter; left time: 12847.1240s
	iters: 200, epoch: 29 | loss: 0.5798478
	speed: 0.3565s/iter; left time: 7681.7725s
	iters: 300, epoch: 29 | loss: 0.5270727
	speed: 0.3545s/iter; left time: 7603.1932s
Epoch: 29 cost time: 108.21212434768677
[2024-12-07 16:55:19] [32mIntermediate result: 0.20706998  (Index 28)[0m
Epoch: 29, Steps: 302 | Train Loss: 0.5135764 Vali Loss: 0.4706832 Test Loss: 0.2070700
EarlyStopping counter: 2 out of 8
Updating learning rate to 6.4535874336755e-05
	iters: 100, epoch: 30 | loss: 0.4427063
	speed: 0.5756s/iter; left time: 12285.2528s
	iters: 200, epoch: 30 | loss: 0.4126674
	speed: 0.3411s/iter; left time: 7245.2406s
	iters: 300, epoch: 30 | loss: 0.4675576
	speed: 0.3321s/iter; left time: 7022.5791s
Epoch: 30 cost time: 102.7124252319336
[2024-12-07 16:57:24] [32mIntermediate result: 0.2067523  (Index 29)[0m
Epoch: 30, Steps: 302 | Train Loss: 0.5133415 Vali Loss: 0.4676701 Test Loss: 0.2067523
EarlyStopping counter: 3 out of 8
Updating learning rate to 5.8082286903079504e-05
	iters: 100, epoch: 31 | loss: 0.5753393
	speed: 0.5904s/iter; left time: 12422.6639s
	iters: 200, epoch: 31 | loss: 0.4319547
	speed: 0.3507s/iter; left time: 7344.6945s
	iters: 300, epoch: 31 | loss: 0.5139508
	speed: 0.3369s/iter; left time: 7020.9050s
Epoch: 31 cost time: 105.77887463569641
[2024-12-07 16:59:32] [32mIntermediate result: 0.20670526  (Index 30)[0m
Epoch: 31, Steps: 302 | Train Loss: 0.5130727 Vali Loss: 0.4679762 Test Loss: 0.2067053
EarlyStopping counter: 4 out of 8
Updating learning rate to 5.227405821277156e-05
	iters: 100, epoch: 32 | loss: 0.5511219
	speed: 0.5878s/iter; left time: 12190.9761s
	iters: 200, epoch: 32 | loss: 0.6227130
	speed: 0.3531s/iter; left time: 7288.0976s
	iters: 300, epoch: 32 | loss: 0.5374268
	speed: 0.3514s/iter; left time: 7218.3793s
Epoch: 32 cost time: 107.18739247322083
[2024-12-07 17:01:41] [32mIntermediate result: 0.20677349  (Index 31)[0m
Epoch: 32, Steps: 302 | Train Loss: 0.5122841 Vali Loss: 0.4680137 Test Loss: 0.2067735
EarlyStopping counter: 5 out of 8
Updating learning rate to 4.704665239149441e-05
	iters: 100, epoch: 33 | loss: 0.4065456
	speed: 0.5770s/iter; left time: 11791.4461s
	iters: 200, epoch: 33 | loss: 0.5597091
	speed: 0.3432s/iter; left time: 6979.8079s
	iters: 300, epoch: 33 | loss: 0.5389468
	speed: 0.3421s/iter; left time: 6922.9567s
Epoch: 33 cost time: 104.05290627479553
[2024-12-07 17:03:47] [32mIntermediate result: 0.20698379  (Index 32)[0m
Epoch: 33, Steps: 302 | Train Loss: 0.5123915 Vali Loss: 0.4698346 Test Loss: 0.2069838
EarlyStopping counter: 6 out of 8
Updating learning rate to 4.234198715234497e-05
	iters: 100, epoch: 34 | loss: 0.4512453
	speed: 0.5911s/iter; left time: 11901.0937s
	iters: 200, epoch: 34 | loss: 0.4925956
	speed: 0.3538s/iter; left time: 7087.5557s
	iters: 300, epoch: 34 | loss: 0.5078280
	speed: 0.3512s/iter; left time: 7001.0406s
Epoch: 34 cost time: 107.48238229751587
[2024-12-07 17:05:58] [32mIntermediate result: 0.20686004  (Index 33)[0m
Epoch: 34, Steps: 302 | Train Loss: 0.5116273 Vali Loss: 0.4681183 Test Loss: 0.2068600
EarlyStopping counter: 7 out of 8
Updating learning rate to 3.810778843711047e-05
	iters: 100, epoch: 35 | loss: 0.6013156
	speed: 0.6002s/iter; left time: 11904.0488s
	iters: 200, epoch: 35 | loss: 0.5817488
	speed: 0.3533s/iter; left time: 6971.7315s
	iters: 300, epoch: 35 | loss: 0.5511221
	speed: 0.3420s/iter; left time: 6714.0318s
Epoch: 35 cost time: 106.02537989616394
[2024-12-07 17:08:07] [32mIntermediate result: 0.20684908  (Index 34)[0m
Epoch: 35, Steps: 302 | Train Loss: 0.5115914 Vali Loss: 0.4635630 Test Loss: 0.2068491
Validation loss decreased (0.466011 --> 0.463563).  Saving model ...
Updating learning rate to 3.429700959339942e-05
	iters: 100, epoch: 36 | loss: 0.4235679
	speed: 0.5742s/iter; left time: 11213.8476s
	iters: 200, epoch: 36 | loss: 0.4768242
	speed: 0.3498s/iter; left time: 6796.0771s
	iters: 300, epoch: 36 | loss: 0.7275053
	speed: 0.3349s/iter; left time: 6473.8316s
Epoch: 36 cost time: 103.03828191757202
[2024-12-07 17:10:13] [32mIntermediate result: 0.20682238  (Index 35)[0m
Epoch: 36, Steps: 302 | Train Loss: 0.5118260 Vali Loss: 0.4676408 Test Loss: 0.2068224
EarlyStopping counter: 1 out of 8
Updating learning rate to 3.086730863405948e-05
	iters: 100, epoch: 37 | loss: 0.4235695
	speed: 0.5842s/iter; left time: 11233.4334s
	iters: 200, epoch: 37 | loss: 0.4998328
	speed: 0.3507s/iter; left time: 6708.0393s
	iters: 300, epoch: 37 | loss: 0.6548930
	speed: 0.3515s/iter; left time: 6689.0868s
Epoch: 37 cost time: 106.2231137752533
[2024-12-07 17:12:22] [32mIntermediate result: 0.2070148  (Index 36)[0m
Epoch: 37, Steps: 302 | Train Loss: 0.5109859 Vali Loss: 0.4649138 Test Loss: 0.2070148
EarlyStopping counter: 2 out of 8
Updating learning rate to 2.7780577770653533e-05
	iters: 100, epoch: 38 | loss: 0.5690687
	speed: 0.5938s/iter; left time: 11238.8306s
	iters: 200, epoch: 38 | loss: 0.4882869
	speed: 0.3523s/iter; left time: 6633.1098s
	iters: 300, epoch: 38 | loss: 0.5436210
	speed: 0.3500s/iter; left time: 6555.1727s
Epoch: 38 cost time: 106.36391592025757
[2024-12-07 17:14:31] [32mIntermediate result: 0.20675766  (Index 37)[0m
Epoch: 38, Steps: 302 | Train Loss: 0.5113340 Vali Loss: 0.4685716 Test Loss: 0.2067577
EarlyStopping counter: 3 out of 8
Updating learning rate to 2.500251999358818e-05
	iters: 100, epoch: 39 | loss: 0.4297810
	speed: 0.5888s/iter; left time: 10966.0010s
	iters: 200, epoch: 39 | loss: 0.5061889
	speed: 0.3547s/iter; left time: 6571.4413s
	iters: 300, epoch: 39 | loss: 0.7914949
	speed: 0.3538s/iter; left time: 6518.9949s
Epoch: 39 cost time: 107.40378713607788
[2024-12-07 17:16:42] [32mIntermediate result: 0.20691198  (Index 38)[0m
Epoch: 39, Steps: 302 | Train Loss: 0.5113991 Vali Loss: 0.4676784 Test Loss: 0.2069120
EarlyStopping counter: 4 out of 8
Updating learning rate to 2.2502267994229363e-05
	iters: 100, epoch: 40 | loss: 0.4313860
	speed: 0.6061s/iter; left time: 11104.9126s
	iters: 200, epoch: 40 | loss: 0.5749873
	speed: 0.3539s/iter; left time: 6448.7418s
	iters: 300, epoch: 40 | loss: 0.6357886
	speed: 0.3334s/iter; left time: 6041.5432s
Epoch: 40 cost time: 105.20014190673828
[2024-12-07 17:18:51] [32mIntermediate result: 0.20701005  (Index 39)[0m
Epoch: 40, Steps: 302 | Train Loss: 0.5111833 Vali Loss: 0.4686006 Test Loss: 0.2070100
EarlyStopping counter: 5 out of 8
Updating learning rate to 2.0252041194806425e-05
	iters: 100, epoch: 41 | loss: 0.4001512
	speed: 0.5924s/iter; left time: 10676.2219s
	iters: 200, epoch: 41 | loss: 0.3933929
	speed: 0.3506s/iter; left time: 6282.7117s
	iters: 300, epoch: 41 | loss: 0.5248604
	speed: 0.3513s/iter; left time: 6260.1632s
Epoch: 41 cost time: 106.45424747467041
[2024-12-07 17:20:59] [32mIntermediate result: 0.20689356  (Index 40)[0m
Epoch: 41, Steps: 302 | Train Loss: 0.5109244 Vali Loss: 0.4685680 Test Loss: 0.2068936
EarlyStopping counter: 6 out of 8
Updating learning rate to 1.8226837075325787e-05
	iters: 100, epoch: 42 | loss: 0.5293644
	speed: 0.5825s/iter; left time: 10321.7853s
	iters: 200, epoch: 42 | loss: 0.6250144
	speed: 0.3479s/iter; left time: 6128.8062s
	iters: 300, epoch: 42 | loss: 0.5411498
	speed: 0.3497s/iter; left time: 6127.1626s
Epoch: 42 cost time: 105.78546667098999
[2024-12-07 17:23:07] [32mIntermediate result: 0.20655738  (Index 41)[0m
Epoch: 42, Steps: 302 | Train Loss: 0.5108390 Vali Loss: 0.4689194 Test Loss: 0.2065574
EarlyStopping counter: 7 out of 8
Updating learning rate to 1.6404153367793208e-05
	iters: 100, epoch: 43 | loss: 0.4520011
	speed: 0.5781s/iter; left time: 10069.4591s
	iters: 200, epoch: 43 | loss: 0.5778996
	speed: 0.3535s/iter; left time: 6122.0417s
	iters: 300, epoch: 43 | loss: 0.5494191
	speed: 0.3577s/iter; left time: 6157.7569s
Epoch: 43 cost time: 106.54024171829224
[2024-12-07 17:25:16] [32mIntermediate result: 0.2066586  (Index 42)[0m
Epoch: 43, Steps: 302 | Train Loss: 0.5107825 Vali Loss: 0.4649678 Test Loss: 0.2066586
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 65_1_1_96_192_MGSformer_TST_custom_ftM_sl96_ll18_pl192_dm45_nh9_el8_dl1_df160_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10348
mse:0.2068488746881485, mae:0.25149449706077576, rse:0.5984218716621399
[2024-12-07 17:25:34] [32mFinal result: 0.20684887[0m
