Args in experiment:
Namespace(accumulation_steps=2, activation='gelu', affine=0, batch_size=32, c_out=7, checkpoints='./checkpoints/', compress_len=10, d_ff=128, d_layers=1, d_model=16, data='custom', data_path='exchange_rate.csv', dec_in=7, decomposition=0, des='Exp', device_ids=[0, 1, 2], devices='0,1,2', distil=True, do_predict=False, dropout=0.3, dvices='0,1,2', e_layers=1, embed='timeF', embed_type=0, enc_in=8, factor=1, fc_dropout=0.3, features='M', freq='h', gpu=0, head_dropout=0.0, individual=0, is_training=1, itr=1, kernel_size=25, label_len=18, learning_rate=0.0001, loss='mse', lradj='type3', model='MGSformer_TST', model_id='Exchange_96_720', momentum=0.8, moving_avg=25, n=1, n_heads=1, n_intra=1, num_workers=10, output_attention=False, padding_patch='end', patch_len=16, patience=8, pct_start=0.3, period=24, pred_len=720, random_seed=2021, revin=1, root_path='./dataset/', seq_len=96, stride=8, subtract_last=0, target='OT', test_flop=False, traffic=0, train_epochs=100, use_amp=False, use_gpu=True, use_multi_gpu=True, x=5)
Use GPU: cuda:0
>>>>>>>start training : 24_1_1_Exchange_96_720_MGSformer_TST_custom_ftM_sl96_ll18_pl720_dm5_nh1_el1_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
module.model.backbone.W_pos_intra: 20
module.model.backbone.W_pos: 120
module.model.backbone.W_pos_coarse: 40
module.model.backbone.W_P_intra.weight: 480
module.model.backbone.W_P_intra.bias: 5
module.model.backbone.W_P.weight: 120
module.model.backbone.W_P.bias: 5
module.model.backbone.W_P_coarse.weight: 400
module.model.backbone.W_P_coarse.bias: 5
module.model.backbone.encoder.layers.0.self_attn.W_Q.weight: 25
module.model.backbone.encoder.layers.0.self_attn.W_Q.bias: 5
module.model.backbone.encoder.layers.0.self_attn.W_K.weight: 25
module.model.backbone.encoder.layers.0.self_attn.W_K.bias: 5
module.model.backbone.encoder.layers.0.self_attn.W_V.weight: 25
module.model.backbone.encoder.layers.0.self_attn.W_V.bias: 5
module.model.backbone.encoder.layers.0.self_attn.to_out.0.weight: 25
module.model.backbone.encoder.layers.0.self_attn.to_out.0.bias: 5
module.model.backbone.encoder.layers.0.norm_attn.1.weight: 5
module.model.backbone.encoder.layers.0.norm_attn.1.bias: 5
module.model.backbone.encoder.layers.0.ff.0.weight: 640
module.model.backbone.encoder.layers.0.ff.0.bias: 128
module.model.backbone.encoder.layers.0.ff.3.weight: 640
module.model.backbone.encoder.layers.0.ff.3.bias: 5
module.model.backbone.encoder.layers.0.norm_ffn.1.weight: 5
module.model.backbone.encoder.layers.0.norm_ffn.1.bias: 5
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.weight: 25
module.model.backbone.encoder_intra.layers.0.self_attn.W_Q.bias: 5
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.weight: 25
module.model.backbone.encoder_intra.layers.0.self_attn.W_K.bias: 5
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.weight: 25
module.model.backbone.encoder_intra.layers.0.self_attn.W_V.bias: 5
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.weight: 25
module.model.backbone.encoder_intra.layers.0.self_attn.to_out.0.bias: 5
module.model.backbone.encoder_intra.layers.0.norm_attn.1.weight: 5
module.model.backbone.encoder_intra.layers.0.norm_attn.1.bias: 5
module.model.backbone.encoder_intra.layers.0.ff.0.weight: 640
module.model.backbone.encoder_intra.layers.0.ff.0.bias: 128
module.model.backbone.encoder_intra.layers.0.ff.3.weight: 640
module.model.backbone.encoder_intra.layers.0.ff.3.bias: 5
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.weight: 5
module.model.backbone.encoder_intra.layers.0.norm_ffn.1.bias: 5
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.weight: 25
module.model.backbone.encoder_coarse.layers.0.self_attn.W_Q.bias: 5
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.weight: 25
module.model.backbone.encoder_coarse.layers.0.self_attn.W_K.bias: 5
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.weight: 25
module.model.backbone.encoder_coarse.layers.0.self_attn.W_V.bias: 5
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.weight: 25
module.model.backbone.encoder_coarse.layers.0.self_attn.to_out.0.bias: 5
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.weight: 5
module.model.backbone.encoder_coarse.layers.0.norm_attn.1.bias: 5
module.model.backbone.encoder_coarse.layers.0.ff.0.weight: 640
module.model.backbone.encoder_coarse.layers.0.ff.0.bias: 128
module.model.backbone.encoder_coarse.layers.0.ff.3.weight: 640
module.model.backbone.encoder_coarse.layers.0.ff.3.bias: 5
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.weight: 5
module.model.backbone.encoder_coarse.layers.0.norm_ffn.1.bias: 5
module.model.head.linear.weight: 363600
module.model.head.linear.bias: 720
module.model.compress.weight: 960
module.model.compress.bias: 10
Total trainable parameters: 371144
train 4496
val 41
test 798
	iters: 100, epoch: 1 | loss: 0.9098570
	speed: 0.0964s/iter; left time: 1340.7191s
Epoch: 1 cost time: 12.061905860900879
[2024-12-08 00:28:20] [32mIntermediate result: 0.9356578  (Index 0)[0m
Epoch: 1, Steps: 140 | Train Loss: 0.8917471 Vali Loss: 1.2847775 Test Loss: 0.9356578
Validation loss decreased (inf --> 1.284778).  Saving model ...
Updating learning rate to 0.0001
	iters: 100, epoch: 2 | loss: 0.7761353
	speed: 0.1263s/iter; left time: 1737.8269s
Epoch: 2 cost time: 10.858492612838745
[2024-12-08 00:28:32] [32mIntermediate result: 0.85350126  (Index 1)[0m
Epoch: 2, Steps: 140 | Train Loss: 0.8562987 Vali Loss: 1.4256581 Test Loss: 0.8535013
EarlyStopping counter: 1 out of 8
Updating learning rate to 0.0001
	iters: 100, epoch: 3 | loss: 0.7648625
	speed: 0.1222s/iter; left time: 1664.3340s
Epoch: 3 cost time: 10.778980255126953
[2024-12-08 00:28:45] [32mIntermediate result: 0.84560966  (Index 2)[0m
Epoch: 3, Steps: 140 | Train Loss: 0.8371106 Vali Loss: 1.3107851 Test Loss: 0.8456097
EarlyStopping counter: 2 out of 8
Updating learning rate to 0.0001
	iters: 100, epoch: 4 | loss: 0.9213120
	speed: 0.1260s/iter; left time: 1698.0962s
Epoch: 4 cost time: 10.572205305099487
[2024-12-08 00:28:57] [32mIntermediate result: 0.8425248  (Index 3)[0m
Epoch: 4, Steps: 140 | Train Loss: 0.8319066 Vali Loss: 1.2754282 Test Loss: 0.8425248
Validation loss decreased (1.284778 --> 1.275428).  Saving model ...
Updating learning rate to 9e-05
	iters: 100, epoch: 5 | loss: 1.0340421
	speed: 0.1273s/iter; left time: 1698.4237s
Epoch: 5 cost time: 10.90506887435913
[2024-12-08 00:29:10] [32mIntermediate result: 0.84228927  (Index 4)[0m
Epoch: 5, Steps: 140 | Train Loss: 0.8275478 Vali Loss: 1.1888491 Test Loss: 0.8422893
Validation loss decreased (1.275428 --> 1.188849).  Saving model ...
Updating learning rate to 8.1e-05
	iters: 100, epoch: 6 | loss: 0.7722942
	speed: 0.1237s/iter; left time: 1633.2197s
Epoch: 6 cost time: 10.61156940460205
[2024-12-08 00:29:22] [32mIntermediate result: 0.8440488  (Index 5)[0m
Epoch: 6, Steps: 140 | Train Loss: 0.8251780 Vali Loss: 1.1957123 Test Loss: 0.8440488
EarlyStopping counter: 1 out of 8
Updating learning rate to 7.290000000000001e-05
	iters: 100, epoch: 7 | loss: 0.8449060
	speed: 0.1244s/iter; left time: 1624.8685s
Epoch: 7 cost time: 10.800848245620728
[2024-12-08 00:29:35] [32mIntermediate result: 0.84186506  (Index 6)[0m
Epoch: 7, Steps: 140 | Train Loss: 0.8216390 Vali Loss: 1.1798053 Test Loss: 0.8418651
Validation loss decreased (1.188849 --> 1.179805).  Saving model ...
Updating learning rate to 6.561e-05
	iters: 100, epoch: 8 | loss: 0.8104378
	speed: 0.1249s/iter; left time: 1613.7863s
Epoch: 8 cost time: 10.773597717285156
[2024-12-08 00:29:47] [32mIntermediate result: 0.84210825  (Index 7)[0m
Epoch: 8, Steps: 140 | Train Loss: 0.8190346 Vali Loss: 1.1676491 Test Loss: 0.8421082
Validation loss decreased (1.179805 --> 1.167649).  Saving model ...
Updating learning rate to 5.904900000000001e-05
	iters: 100, epoch: 9 | loss: 0.9087992
	speed: 0.1261s/iter; left time: 1612.2668s
Epoch: 9 cost time: 10.689834117889404
[2024-12-08 00:30:00] [32mIntermediate result: 0.84850425  (Index 8)[0m
Epoch: 9, Steps: 140 | Train Loss: 0.8177355 Vali Loss: 1.1529175 Test Loss: 0.8485042
Validation loss decreased (1.167649 --> 1.152918).  Saving model ...
Updating learning rate to 5.3144100000000005e-05
	iters: 100, epoch: 10 | loss: 0.7183986
	speed: 0.1264s/iter; left time: 1597.2369s
Epoch: 10 cost time: 10.824408292770386
[2024-12-08 00:30:12] [32mIntermediate result: 0.8469518  (Index 9)[0m
Epoch: 10, Steps: 140 | Train Loss: 0.8152509 Vali Loss: 1.1810132 Test Loss: 0.8469518
EarlyStopping counter: 1 out of 8
Updating learning rate to 4.782969000000001e-05
	iters: 100, epoch: 11 | loss: 0.8519519
	speed: 0.1239s/iter; left time: 1549.1307s
Epoch: 11 cost time: 10.68476915359497
[2024-12-08 00:30:25] [32mIntermediate result: 0.8458803  (Index 10)[0m
Epoch: 11, Steps: 140 | Train Loss: 0.8144191 Vali Loss: 1.2035807 Test Loss: 0.8458803
EarlyStopping counter: 2 out of 8
Updating learning rate to 4.304672100000001e-05
	iters: 100, epoch: 12 | loss: 0.7495317
	speed: 0.1238s/iter; left time: 1529.7753s
Epoch: 12 cost time: 10.675474882125854
[2024-12-08 00:30:37] [32mIntermediate result: 0.8466652  (Index 11)[0m
Epoch: 12, Steps: 140 | Train Loss: 0.8127758 Vali Loss: 1.1582506 Test Loss: 0.8466652
EarlyStopping counter: 3 out of 8
Updating learning rate to 3.874204890000001e-05
	iters: 100, epoch: 13 | loss: 0.8902870
	speed: 0.1259s/iter; left time: 1538.7440s
Epoch: 13 cost time: 10.675302505493164
[2024-12-08 00:30:50] [32mIntermediate result: 0.8507325  (Index 12)[0m
Epoch: 13, Steps: 140 | Train Loss: 0.8121300 Vali Loss: 1.1919756 Test Loss: 0.8507325
EarlyStopping counter: 4 out of 8
Updating learning rate to 3.486784401000001e-05
	iters: 100, epoch: 14 | loss: 0.7395345
	speed: 0.1239s/iter; left time: 1496.6908s
Epoch: 14 cost time: 10.685902118682861
[2024-12-08 00:31:02] [32mIntermediate result: 0.84981614  (Index 13)[0m
Epoch: 14, Steps: 140 | Train Loss: 0.8103696 Vali Loss: 1.2016588 Test Loss: 0.8498161
EarlyStopping counter: 5 out of 8
Updating learning rate to 3.138105960900001e-05
	iters: 100, epoch: 15 | loss: 0.7390330
	speed: 0.1281s/iter; left time: 1529.5757s
Epoch: 15 cost time: 11.054964065551758
[2024-12-08 00:31:15] [32mIntermediate result: 0.85302955  (Index 14)[0m
Epoch: 15, Steps: 140 | Train Loss: 0.8095737 Vali Loss: 1.1700659 Test Loss: 0.8530295
EarlyStopping counter: 6 out of 8
Updating learning rate to 2.824295364810001e-05
	iters: 100, epoch: 16 | loss: 0.9603353
	speed: 0.1266s/iter; left time: 1493.4312s
Epoch: 16 cost time: 10.845333099365234
[2024-12-08 00:31:28] [32mIntermediate result: 0.8536987  (Index 15)[0m
Epoch: 16, Steps: 140 | Train Loss: 0.8082446 Vali Loss: 1.1628501 Test Loss: 0.8536987
EarlyStopping counter: 7 out of 8
Updating learning rate to 2.541865828329001e-05
	iters: 100, epoch: 17 | loss: 0.7947847
	speed: 0.1235s/iter; left time: 1440.4269s
Epoch: 17 cost time: 10.413620233535767
[2024-12-08 00:31:40] [32mIntermediate result: 0.85499287  (Index 16)[0m
Epoch: 17, Steps: 140 | Train Loss: 0.8087489 Vali Loss: 1.1939728 Test Loss: 0.8549929
EarlyStopping counter: 8 out of 8
Early stopping
>>>>>>>testing : 24_1_1_Exchange_96_720_MGSformer_TST_custom_ftM_sl96_ll18_pl720_dm5_nh1_el1_dl1_df128_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 798
mse:0.8485044240951538, mae:0.6940389275550842, rse:0.7265095710754395
[2024-12-08 00:31:42] [32mFinal result: 0.8485044[0m
